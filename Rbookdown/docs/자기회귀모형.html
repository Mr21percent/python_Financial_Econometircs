<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 4.3 자기회귀모형 | A Minimal Book Example</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 4.3 자기회귀모형 | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 4.3 자기회귀모형 | A Minimal Book Example" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="John Doe" />


<meta name="date" content="2022-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="기초-개념.html"/>
<link rel="next" href="이동평균-모형.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="제4장-안정적-시게열모형의-추정과-예측.html"><a href="제4장-안정적-시게열모형의-추정과-예측.html"><i class="fa fa-check"></i><b>2</b> 제4장 안정적 시게열모형의 추정과 예측</a></li>
<li class="chapter" data-level="3" data-path="시작에-앞서-python을-사용하기-위한-설정.html"><a href="시작에-앞서-python을-사용하기-위한-설정.html"><i class="fa fa-check"></i><b>3</b> 시작에 앞서 python을 사용하기 위한 설정</a></li>
<li class="chapter" data-level="4" data-path="일반적인-시계열-분석-과정의-이해.html"><a href="일반적인-시계열-분석-과정의-이해.html"><i class="fa fa-check"></i><b>4</b> 4.1 일반적인 시계열 분석 과정의 이해</a></li>
<li class="chapter" data-level="5" data-path="기초-개념.html"><a href="기초-개념.html"><i class="fa fa-check"></i><b>5</b> 4.2 기초 개념</a>
<ul>
<li class="chapter" data-level="5.1" data-path="기초-개념.html"><a href="기초-개념.html#확률과정"><i class="fa fa-check"></i><b>5.1</b> 4.2.1 확률과정</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="기초-개념.html"><a href="기초-개념.html#section"><i class="fa fa-check"></i><b>5.1.1</b> -</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="기초-개념.html"><a href="기초-개념.html#안정성-자기공분산-및-자기-상관"><i class="fa fa-check"></i><b>5.2</b> 4.2.2 안정성, 자기공분산 및 자기 상관</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="기초-개념.html"><a href="기초-개념.html#section-1"><i class="fa fa-check"></i><b>5.2.1</b> -</a></li>
<li class="chapter" data-level="5.2.2" data-path="기초-개념.html"><a href="기초-개념.html#예제-안정적-시계열-표본자기상관함수-및-유의성-검정"><i class="fa fa-check"></i><b>5.2.2</b> 예제) 안정적 시계열, 표본자기상관함수 및 유의성 검정</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="기초-개념.html"><a href="기초-개념.html#편자기상관"><i class="fa fa-check"></i><b>5.3</b> 4.2.3 편자기상관</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="기초-개념.html"><a href="기초-개념.html#section-2"><i class="fa fa-check"></i><b>5.3.1</b> -</a></li>
<li class="chapter" data-level="5.3.2" data-path="기초-개념.html"><a href="기초-개념.html#예제-표본편자기상관함수자기상관함수와-편자기상관함수"><i class="fa fa-check"></i><b>5.3.2</b> 예제) 표본편자기상관함수(자기상관함수와 편자기상관함수)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="기초-개념.html"><a href="기초-개념.html#월드분해정리와-선형필터"><i class="fa fa-check"></i><b>5.4</b> 4.2.4 월드분해정리와 선형필터</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="자기회귀모형.html"><a href="자기회귀모형.html"><i class="fa fa-check"></i><b>6</b> 4.3 자기회귀모형</a>
<ul>
<li class="chapter" data-level="6.1" data-path="자기회귀모형.html"><a href="자기회귀모형.html#section-4"><i class="fa fa-check"></i><b>6.1</b> -</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="자기회귀모형.html"><a href="자기회귀모형.html#예시-안정성-조건-확인"><i class="fa fa-check"></i><b>6.1.1</b> 예시 (안정성 조건 확인)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="자기회귀모형.html"><a href="자기회귀모형.html#ar1-모형"><i class="fa fa-check"></i><b>6.2</b> 4.3.1 AR(1) 모형</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="자기회귀모형.html"><a href="자기회귀모형.html#section-5"><i class="fa fa-check"></i><b>6.2.1</b> -</a></li>
<li class="chapter" data-level="6.2.2" data-path="자기회귀모형.html"><a href="자기회귀모형.html#예제-ar1과정-시뮬레이션"><i class="fa fa-check"></i><b>6.2.2</b> 예제) AR(1)과정 : 시뮬레이션</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="자기회귀모형.html"><a href="자기회귀모형.html#ar2-모형"><i class="fa fa-check"></i><b>6.3</b> 4.3.2 AR(2) 모형</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="자기회귀모형.html"><a href="자기회귀모형.html#section-6"><i class="fa fa-check"></i><b>6.3.1</b> -</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="자기회귀모형.html"><a href="자기회귀모형.html#p-차-자기회귀모형arp-모형"><i class="fa fa-check"></i><b>6.4</b> 4.3.3 p-차 자기회귀모형(AR(p) 모형)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="자기회귀모형.html"><a href="자기회귀모형.html#section-7"><i class="fa fa-check"></i><b>6.4.1</b> -</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="자기회귀모형.html"><a href="자기회귀모형.html#arp-모형의-mainfty-모형으로의-전환"><i class="fa fa-check"></i><b>6.5</b> 4.3.4 AR(p) 모형의 MA(<span class="math inline">\(\infty\)</span>) 모형으로의 전환</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="자기회귀모형.html"><a href="자기회귀모형.html#section-8"><i class="fa fa-check"></i><b>6.5.1</b> -</a></li>
<li class="chapter" data-level="6.5.2" data-path="자기회귀모형.html"><a href="자기회귀모형.html#diy-예제-충격반응함수"><i class="fa fa-check"></i><b>6.5.2</b> diy 예제) 충격반응함수</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="이동평균-모형.html"><a href="이동평균-모형.html"><i class="fa fa-check"></i><b>7</b> 4.4 이동평균 모형</a>
<ul>
<li class="chapter" data-level="7.1" data-path="이동평균-모형.html"><a href="이동평균-모형.html#section-9"><i class="fa fa-check"></i><b>7.1</b> -</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="이동평균-모형.html"><a href="이동평균-모형.html#section-10"><i class="fa fa-check"></i><b>7.1.1</b> -</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="이동평균-모형.html"><a href="이동평균-모형.html#ma1-모형"><i class="fa fa-check"></i><b>7.2</b> 4.4.1 MA(1) 모형</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="이동평균-모형.html"><a href="이동평균-모형.html#section-11"><i class="fa fa-check"></i><b>7.2.1</b> -</a></li>
<li class="chapter" data-level="7.2.2" data-path="이동평균-모형.html"><a href="이동평균-모형.html#예제-ma1과정의-실현값-시뮬레이션"><i class="fa fa-check"></i><b>7.2.2</b> 예제) MA(1)과정의 실현값 : 시뮬레이션</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="이동평균-모형.html"><a href="이동평균-모형.html#ma2-모형"><i class="fa fa-check"></i><b>7.3</b> 4.4.2 MA(2) 모형</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="이동평균-모형.html"><a href="이동평균-모형.html#section-12"><i class="fa fa-check"></i><b>7.3.1</b> -</a></li>
<li class="chapter" data-level="7.3.2" data-path="이동평균-모형.html"><a href="이동평균-모형.html#예제-ma2과정의-실현값"><i class="fa fa-check"></i><b>7.3.2</b> 예제) MA(2)과정의 실현값</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="이동평균-모형.html"><a href="이동평균-모형.html#q-차-이동평균모형maq모형"><i class="fa fa-check"></i><b>7.4</b> 4.4.3 q-차 이동평균모형(MA(q)모형)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="자기회귀---이동평균모형armapq-models.html"><a href="자기회귀---이동평균모형armapq-models.html"><i class="fa fa-check"></i><b>8</b> 4.5 자기회귀 - 이동평균모형(ARMA(p,q) models)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="자기회귀---이동평균모형armapq-models.html"><a href="자기회귀---이동평균모형armapq-models.html#arma11-과정"><i class="fa fa-check"></i><b>8.1</b> 4.5.1 ARMA(1,1) 과정</a></li>
<li class="chapter" data-level="8.2" data-path="자기회귀---이동평균모형armapq-models.html"><a href="자기회귀---이동평균모형armapq-models.html#armapq-모형"><i class="fa fa-check"></i><b>8.2</b> 4.5.2 ARMA(p,q) 모형</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="armapq모형의-추정.html"><a href="armapq모형의-추정.html"><i class="fa fa-check"></i><b>9</b> 4.6 ARMA(p,q)모형의 추정</a>
<ul>
<li class="chapter" data-level="9.1" data-path="armapq모형의-추정.html"><a href="armapq모형의-추정.html#최우추정mle"><i class="fa fa-check"></i><b>9.1</b> 4.6.1 최우추정(MLE)</a></li>
<li class="chapter" data-level="9.2" data-path="armapq모형의-추정.html"><a href="armapq모형의-추정.html#수치최적화"><i class="fa fa-check"></i><b>9.2</b> 4.6.2 수치최적화</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="적정-armapq모형-선정-절차---diagnostic-checking.html"><a href="적정-armapq모형-선정-절차---diagnostic-checking.html"><i class="fa fa-check"></i><b>10</b> 4.7 적정 ARMA(p,q)모형 선정 절차 - Diagnostic Checking</a></li>
<li class="chapter" data-level="11" data-path="arma-모형의-예측.html"><a href="arma-모형의-예측.html"><i class="fa fa-check"></i><b>11</b> 4.8 ARMA 모형의 예측</a>
<ul>
<li class="chapter" data-level="11.1" data-path="arma-모형의-예측.html"><a href="arma-모형의-예측.html#arma-pq-모형의-예측의-기본원리"><i class="fa fa-check"></i><b>11.1</b> 4.8.1 ARMA (p,q) 모형의 예측의 기본원리</a></li>
<li class="chapter" data-level="11.2" data-path="arma-모형의-예측.html"><a href="arma-모형의-예측.html#예측오차"><i class="fa fa-check"></i><b>11.2</b> 4.8.2 예측오차</a></li>
<li class="chapter" data-level="11.3" data-path="arma-모형의-예측.html"><a href="arma-모형의-예측.html#armapq모형의-최소-mse-예측"><i class="fa fa-check"></i><b>11.3</b> 4.8.3 ARMA(p,q)모형의 최소 MSE 예측</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="fractionally-integrated-arma-과정-farimapdq.html"><a href="fractionally-integrated-arma-과정-farimapdq.html"><i class="fa fa-check"></i><b>12</b> 4.9 Fractionally Integrated ARMA 과정 : FARIMA(p,d,q)</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="자기회귀모형" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> 4.3 자기회귀모형<a href="자기회귀모형.html#자기회귀모형" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="section-4" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> -<a href="자기회귀모형.html#section-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>일반적인 ’p-차 자기회귀모형’은 다음과 같이 쓸 수 있으며 기호로 AR(p)라고 표시한다.</p>
<p><span class="math display">\[
x_t=\phi_1x_{t-1}+\phi_2x_{t-2}+\cdots+\phi_px_{t-p}+a_t\\
또는\\
(1-\phi_1L-\phi_2L^2-\cdots-\phi_pL^p)=a_t\\
\phi(L)x_t=a_t
\]</span></p>
<p>확률과정 x_t가 안정적이기 위해서는 래그다항식 <span class="math inline">\(\phi(L)\)</span>의 행렬식(determinant)을 0으로 두었을 때 이의 모든 근(또는 해)이 ‘복소수 단위원’의 ’밖에’ 존재하여야 한다. 즉,</p>
<p><span class="math display">\[
1-\phi_1z-\phi_2z^2-\cdots-\phi_pz^p=0
\]</span></p>
<p>에서 z의 모든 근(차수 p개만큼 존재할 것으로 기대)이 복소수 단위원(complex unit circle)의 밖에(outside) 존재하여야 한다.</p>
<p>안정성 조건을 달리 표현하는 방법도 있다. AR(<span class="math inline">\(p\)</span>)모형을 따르는 시계열 <span class="math inline">\(x_t\)</span>의 자기상관함수는 후술하는 것 처럼 <span class="math inline">\(p\)</span>-차 차분방정식의 형태를 가지므로 이의 특성방정식(characteristic equation)의 일반해는 다음과 같다.</p>
<p><span class="math display">\[
\rho_k = c_1\lambda_1^k + c_2\lambda_2^k + \cdots + c_p\lambda_p^k \quad for \quad k\ge0
\]</span></p>
<p>단, <span class="math inline">\(\lambda_i\)</span>는 <span class="math inline">\(z^p-\phi_1z^{p-1}-\cdots-\phi_p=0\)</span> 방정식의 해이다. 이 경우 차분 방정식이론에 따르면 <span class="math inline">\(x_t\)</span>의 안정성 조건은 <span class="math inline">\(\lambda\)</span>가 모두 복소수 단위원의 안(inside)에 존재하는 것이다.</p>
<div id="예시-안정성-조건-확인" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 예시 (안정성 조건 확인)<a href="자기회귀모형.html#예시-안정성-조건-확인" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>AR(2)모형으로 설정하고 추정하였다고 하자.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="자기회귀모형.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb30-2"><a href="자기회귀모형.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.ar_model <span class="im">import</span> AutoReg</span>
<span id="cb30-3"><a href="자기회귀모형.html#cb30-3" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> AutoReg(data, lags <span class="op">=</span> <span class="dv">2</span>).fit()</span></code></pre></div>
<pre><code>## C:\Users\user\Desktop\FINTIM~1\python\lib\site-packages\statsmodels\tsa\base\tsa_model.py:471: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
##   self._init_dates(dates, freq)</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="자기회귀모형.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res.summary())</span></code></pre></div>
<pre><code>##                             AutoReg Model Results                             
## ==============================================================================
## Dep. Variable:                    rtn   No. Observations:                 5427
## Model:                     AutoReg(2)   Log Likelihood               15203.551
## Method:               Conditional MLE   S.D. of innovations              0.015
## Date:                    금, 29 7 2022   AIC                         -30399.103
## Time:                        06:01:54   BIC                         -30372.708
## Sample:                             2   HQIC                        -30389.890
##                                  5427                                         
## ==============================================================================
##                  coef    std err          z      P&gt;|z|      [0.025      0.975]
## ------------------------------------------------------------------------------
## const          0.0003      0.000      1.590      0.112   -7.38e-05       0.001
## rtn.L1         0.0157      0.014      1.158      0.247      -0.011       0.042
## rtn.L2        -0.0169      0.014     -1.251      0.211      -0.043       0.010
##                                     Roots                                    
## =============================================================================
##                   Real          Imaginary           Modulus         Frequency
## -----------------------------------------------------------------------------
## AR.1            0.4636           -7.6674j            7.6814           -0.2404
## AR.2            0.4636           +7.6674j            7.6814            0.2404
## -----------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="자기회귀모형.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res.diagnostic_summary())</span></code></pre></div>
<pre><code>##        Test of No Serial Correlation       
## ===========================================
##        Lag  Ljung-Box LB P-value         DF
## -------------------------------------------
##          1      2.103      0.147          1
##          2      6.859      0.032          2
##          3      6.861      0.076          3
##          4      9.329      0.053          4
##          5      9.670      0.085          5
##          6      9.746      0.136          6
##          7      9.930      0.193          7
## 
## 
##              Test of Normality              
## ============================================
## Jarque-Bera    P-value   Skewness   Kurtosis
## --------------------------------------------
##   10196.802      0.000     -0.364      9.677
## 
## 
##     Test of Conditional Homoskedasticity   
## ===========================================
##        Lag    ARCH-LM    P-value         DF
## -------------------------------------------
##          1    285.053      0.000          1
##          2    504.296      0.000          2
##          3    533.704      0.000          3
##          4    684.522      0.000          4
##          5    782.091      0.000          5
##          6    808.062      0.000          6
##          7    807.901      0.000          7
##          8    813.591      0.000          8
##          9    823.510      0.000          9
##         10    859.046      0.000         10
## -------------------------------------------</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="자기회귀모형.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AR Roots : &quot;</span>, res.roots)</span></code></pre></div>
<pre><code>## AR Roots :  [0.46357281-7.66742076j 0.46357281+7.66742076j]</code></pre>
<p>다음은 AR[0,0,0,0,5]를 추정한 결과이다.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="자기회귀모형.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb38-2"><a href="자기회귀모형.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.ar_model <span class="im">import</span> AutoReg</span>
<span id="cb38-3"><a href="자기회귀모형.html#cb38-3" aria-hidden="true" tabindex="-1"></a>res2 <span class="op">=</span> AutoReg(data, lags <span class="op">=</span> [<span class="dv">5</span>]).fit()</span></code></pre></div>
<pre><code>## C:\Users\user\Desktop\FINTIM~1\python\lib\site-packages\statsmodels\tsa\base\tsa_model.py:471: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
##   self._init_dates(dates, freq)</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="자기회귀모형.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res2.summary())</span></code></pre></div>
<pre><code>##                             AutoReg Model Results                             
## ==============================================================================
## Dep. Variable:                    rtn   No. Observations:                 5427
## Model:              Restr. AutoReg(5)   Log Likelihood               15198.582
## Method:               Conditional MLE   S.D. of innovations              0.015
## Date:                    금, 29 7 2022   AIC                         -30391.164
## Time:                        06:01:55   BIC                         -30371.369
## Sample:                             5   HQIC                        -30384.255
##                                  5427                                         
## ==============================================================================
##                  coef    std err          z      P&gt;|z|      [0.025      0.975]
## ------------------------------------------------------------------------------
## const          0.0003      0.000      1.612      0.107   -6.93e-05       0.001
## rtn.L5        -0.0278      0.014     -2.052      0.040      -0.054      -0.001
##                                     Roots                                    
## =============================================================================
##                   Real          Imaginary           Modulus         Frequency
## -----------------------------------------------------------------------------
## AR.1           -2.0478           -0.0000j            2.0478           -0.5000
## AR.2           -0.6328           -1.9476j            2.0478           -0.3000
## AR.3           -0.6328           +1.9476j            2.0478            0.3000
## AR.4            1.6567           -1.2037j            2.0478           -0.1000
## AR.5            1.6567           +1.2037j            2.0478            0.1000
## -----------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="자기회귀모형.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res2.diagnostic_summary())</span></code></pre></div>
<pre><code>##        Test of No Serial Correlation       
## ===========================================
##        Lag  Ljung-Box LB P-value         DF
## -------------------------------------------
##          1      2.847      0.092          1
##          2      4.638      0.098          2
##          3      4.698      0.195          3
##          4      4.698      0.320          4
##          5      6.853      0.232          5
##          6      7.133      0.309          6
##          7      7.160      0.412          7
##          8      7.508      0.483          8
## 
## 
##              Test of Normality              
## ============================================
## Jarque-Bera    P-value   Skewness   Kurtosis
## --------------------------------------------
##   10140.655      0.000     -0.387      9.655
## 
## 
##     Test of Conditional Homoskedasticity   
## ===========================================
##        Lag    ARCH-LM    P-value         DF
## -------------------------------------------
##          1    286.833      0.000          1
##          2    513.782      0.000          2
##          3    541.687      0.000          3
##          4    697.659      0.000          4
##          5    793.518      0.000          5
##          6    817.815      0.000          6
##          7    818.163      0.000          7
##          8    823.956      0.000          8
##          9    832.184      0.000          9
##         10    864.609      0.000         10
## -------------------------------------------</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="자기회귀모형.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AR Roots </span><span class="ch">\n</span><span class="st">===========================================</span><span class="ch">\n</span><span class="st"> &quot;</span>, res2.roots)</span></code></pre></div>
<pre><code>## AR Roots 
## ===========================================
##   [-2.04778776-0.j         -0.63280122-1.94756189j -0.63280122+1.94756189j
##   1.6566951 -1.20365944j  1.6566951 +1.20365944j]</code></pre>
</div>
</div>
<div id="ar1-모형" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 4.3.1 AR(1) 모형<a href="자기회귀모형.html#ar1-모형" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-5" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> -<a href="자기회귀모형.html#section-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>자기회귀모형의 특성을 이의 가장 간단한 형태인 AR(1) 모형을 사용하여 살펴보자.</p>
<p><span class="math display">\[
x_t = \phi x_{t-1} + a_t \\
또는\\
(1-\phi L)x_t = \phi(L)x_t = a_t
\]</span></p>
<p><span class="math inline">\(x_t\)</span>가 안정적 과정인 경우 식을 다음과 같이 변형할 수 있을 것이다.</p>
<p><span class="math display">\[
x_t = (1-\phi L)^{-1}a_t\\
=(1+\phi L + \phi ^2L^2+\cdots)a_t\\
=a_t + \phi a_{t-1}+ \phi ^2 a_{t-2}+ \phi^3 a_{t-3} + \cdots
\]</span></p>
<p>안정적 과정에서 <span class="math inline">\(E(x^2_t)=E(x^2_{t-k})=\sigma^2_x=\gamma_0\)</span>가 성립하므로</p>
<p><span class="math display">\[
E(x_t)=0 \quad \forall t\\
Var(x_t)=E[(x_t-E(x_t))^2]=\sigma^2+\phi^2 \sigma^2 + \phi^4 \sigma^2 + \cdots\\
=\frac{1}{1-\phi^2}\sigma^2
\]</span></p>
<p>식은 <span class="math inline">\(x_t\)</span>의 비조건부평균, 즉 장기평균값이 영임을 보여주고 있다. 만일 AR(1)과정을 보다 일반적으로</p>
<p><span class="math display">\[
x_t - \mu = \phi(x_{t-1}-\mu)+a_t
\]</span></p>
<p>와 같이 평균으로부터의 이탈부분이 자기회귀하는 것으로 설정하였다면, <span class="math inline">\(E(x_t) = 1/(1-\phi L) = 1/(1-\phi)\)</span>가 된다. 두 번째 등호가 성립하는 이유는 상수에 래그를 취해도 상수이기 때문이다. (즉, <span class="math inline">\(cL=L\)</span>)</p>
<p><span class="math inline">\(Var(x_t)=\sigma^2/(1-\phi^2)\)</span>에서 AR(1)과정의 비조건부분산, 즉 장기분산값을 나타내는데 <span class="math inline">\(|\phi|&lt;1\)</span>로 인한 확률과정 <span class="math inline">\(x_t\)</span>의 분산 <span class="math inline">\(Var(x_t)\)</span>는 백색잡음의 분산 <span class="math inline">\(\sigma^2\)</span>보다 큼을 알 수 있다. 잔차항의 변동폭이 실제값의 변동폭보다 작은 것이 바로 이 이유에서 비롯함을 알 수 있다.</p>
<p>AR(1)과정의 공분산(covariance)의 특성을 살펴보자.</p>
<p><span class="math display">\[
\gamma_k = E[(x_t-E(x_t))(x_{t-k}-E(x_{t-k}))]\\
=E[(\phi^k x_{t-k}+\Sigma^{k-1}_{j=0}\phi^j a_{t-j})x_{t-k}]\\
=\phi^k \gamma_0 \quad (\because x_{t-k}=\Sigma^{\infty}_{j=0}\phi^j a_{t-k-j})\\
=\phi(\phi^{k-1}\gamma_0)=\phi \gamma_{k-1}
\]</span></p>
<p>그러므로 AR(1)모형은 공분산과정 방적식과 자료생성모형이 서로 같다는 특성이 있다.그리고 <span class="math inline">\(|\phi|&lt;1\)</span>가 만족하면 <strong>‘안정성조건’</strong>을 만족한다고 한다.</p>
<div id="ar1모형의-안정성-조건" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> AR(1)모형의 안정성 조건<a href="자기회귀모형.html#ar1모형의-안정성-조건" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>앞에서 설명한 안정성 조건을 AR(1)모형에 적용하여 보면 <span class="math inline">\(\phi(L)=1-\phi L\)</span>이므로 안정성을 위해서는 <span class="math inline">\(|\phi(L)|=0\)</span>의 근이 단위원 밖에 존재하여야 한다. 즉,</p>
<p><span class="math display">\[
|1-\phi z| = 0 \quad or \quad |z|=1/|\phi|
\]</span></p>
<p>그러므로 안정성 조건 <span class="math inline">\(|z|&gt;1\)</span>은 <span class="math inline">\(|\phi|&lt;1\)</span>을 의미한다. 만일 근이 경계선상인 1이면 안정성 조건을 만족하지 않으며 이는 <strong>“확률보행과정”(random walk process)</strong>라고 할 수 있을 것이다. 이 경우 분산이 발산한다.</p>
</div>
<div id="ar1모형의-자기상관함수acf" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> AR(1)모형의 자기상관함수(ACF)<a href="자기회귀모형.html#ar1모형의-자기상관함수acf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>AR(1)모형의 자기상관함수는 다음과 같이 계산한다.</p>
<p><span class="math display">\[
\rho_k = \gamma_k/\gamma_0 = \phi^k
\]</span></p>
<p>그러므로 안정성 조건을 만족하면서 <span class="math inline">\(phi&gt;0\)</span>이면 ACF는 <span class="math inline">\(k\)</span>가 증가함에 따라 지수적으로 0에 가까워지고 만일 <span class="math inline">\(\phi&lt;0\)</span>이면 ACF는 진동하는(oscillatory)형태로 0에 접근한다. 두 경우 모두 <span class="math inline">\(\phi\)</span>가 비정상과정이 되는 한계값 <span class="math inline">\(\pm1\)</span>에 가까운 경우 감소하는 속도는 매우 느리게 된다. 표본 ACF <span class="math inline">\(\hat{\rho}_k\)</span>의 표준편차는 다음과 같다.</p>
<p><span class="math display">\[
SD(\hat{\rho}_k) \simeq \sqrt{(\frac{1}{T})(1+2\hat{\rho}^2_1+\cdots+2\hat{\rho}^2_{k-1})}
\]</span></p>
</div>
<div id="ar1-모형의-편자기상관함수partial-acf" class="section level4 hasAnchor" number="6.2.1.3">
<h4><span class="header-section-number">6.2.1.3</span> AR(1) 모형의 편자기상관함수(Partial ACF)<a href="자기회귀모형.html#ar1-모형의-편자기상관함수partial-acf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>AR(1) 모형의 PACF는 다음과 같다.</p>
<p><span class="math display">\[
\phi_{kk} = \begin {cases} \rho_1 = \phi_1, \quad k=1 \\ 0, \quad k \ge 2 \end {cases}
\]</span></p>
<p>그러므로 AR(1)과정의 PACF는<span class="math inline">\(\phi_1\)</span>의 부호에 따라 <strong>첫 번째 래그에서 양 또는 음의 스파이크를 보이고 그 후의 래그에서는 없어진다.</strong> 표본 PACF <span class="math inline">\(\hat{\phi}_{kk}\)</span>의 SD는 <span class="math inline">\(1/\sqrt T\)</span>이다.</p>
</div>
</div>
<div id="예제-ar1과정-시뮬레이션" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> 예제) AR(1)과정 : 시뮬레이션<a href="자기회귀모형.html#예제-ar1과정-시뮬레이션" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>다음은 두 개의 AR(1)과정의 시뮬레이션이다. AR1_95와 AR1_30은 각각 <span class="math inline">\(\phi = 0.95, \phi = 0.3\)</span>을 가정한 것이고 두 계열 모두 비조건부평균을 0으로 가정하였다.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="자기회귀모형.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.arima_process <span class="im">import</span> ArmaProcess</span>
<span id="cb46-2"><a href="자기회귀모형.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="자기회귀모형.html#cb46-3" aria-hidden="true" tabindex="-1"></a>plt.cla()</span>
<span id="cb46-4"><a href="자기회귀모형.html#cb46-4" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb46-5"><a href="자기회귀모형.html#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="자기회귀모형.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ar1_95 phi = 0.95</span></span>
<span id="cb46-7"><a href="자기회귀모형.html#cb46-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb46-8"><a href="자기회귀모형.html#cb46-8" aria-hidden="true" tabindex="-1"></a>ar1_95_ar_parm <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.95</span>]) <span class="co"># 0.95를 넣기 위해서는 음수로 넣어야 하며, 1은 lag 0에서를 의미함.</span></span>
<span id="cb46-9"><a href="자기회귀모형.html#cb46-9" aria-hidden="true" tabindex="-1"></a>ar1_95_ma_parm <span class="op">=</span> np.array([<span class="dv">1</span>])</span>
<span id="cb46-10"><a href="자기회귀모형.html#cb46-10" aria-hidden="true" tabindex="-1"></a>AR1_95 <span class="op">=</span> ArmaProcess(ar1_95_ar_parm, ar1_95_ma_parm).generate_sample(nsample<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb46-11"><a href="자기회귀모형.html#cb46-11" aria-hidden="true" tabindex="-1"></a>plt.plot(AR1_95)</span>
<span id="cb46-12"><a href="자기회귀모형.html#cb46-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;AR(1)=0.95&#39;</span>)</span>
<span id="cb46-13"><a href="자기회귀모형.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="자기회귀모형.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ar1_30 phi = 0.3</span></span>
<span id="cb46-15"><a href="자기회귀모형.html#cb46-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb46-16"><a href="자기회귀모형.html#cb46-16" aria-hidden="true" tabindex="-1"></a>ar1_30_ar_parm <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.3</span>])</span>
<span id="cb46-17"><a href="자기회귀모형.html#cb46-17" aria-hidden="true" tabindex="-1"></a>ar1_30_ma_parm <span class="op">=</span> np.array([<span class="dv">1</span>])</span>
<span id="cb46-18"><a href="자기회귀모형.html#cb46-18" aria-hidden="true" tabindex="-1"></a>AR1_30 <span class="op">=</span> ArmaProcess(ar1_30_ar_parm, ar1_30_ma_parm).generate_sample(nsample<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb46-19"><a href="자기회귀모형.html#cb46-19" aria-hidden="true" tabindex="-1"></a>plt.plot(AR1_30)</span>
<span id="cb46-20"><a href="자기회귀모형.html#cb46-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;AR(1)=0.30&#39;</span>)</span>
<span id="cb46-21"><a href="자기회귀모형.html#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="자기회귀모형.html#cb46-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-23"><a href="자기회귀모형.html#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">#ar1_95 acf</span></span>
<span id="cb46-24"><a href="자기회귀모형.html#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="자기회귀모형.html#cb46-25" aria-hidden="true" tabindex="-1"></a>plot_acf(AR1_95, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">1</span>,<span class="dv">0</span>], title <span class="op">=</span><span class="st">&#39;AR1_95 ACF&#39;</span>)</span>
<span id="cb46-26"><a href="자기회귀모형.html#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="자기회귀모형.html#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">#ar1_30 acf</span></span>
<span id="cb46-28"><a href="자기회귀모형.html#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="자기회귀모형.html#cb46-29" aria-hidden="true" tabindex="-1"></a>plot_acf(AR1_30, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">1</span>,<span class="dv">1</span>], title <span class="op">=</span><span class="st">&#39;AR1_30 ACF&#39;</span>)</span>
<span id="cb46-30"><a href="자기회귀모형.html#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="자기회귀모형.html#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co">#ar1_95 pacf</span></span>
<span id="cb46-32"><a href="자기회귀모형.html#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="자기회귀모형.html#cb46-33" aria-hidden="true" tabindex="-1"></a>plot_pacf(AR1_95, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">2</span>,<span class="dv">0</span>],  title <span class="op">=</span><span class="st">&#39;AR1_95 PACF&#39;</span>)</span>
<span id="cb46-34"><a href="자기회귀모형.html#cb46-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-35"><a href="자기회귀모형.html#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="co">#ar1_30 pacf</span></span>
<span id="cb46-36"><a href="자기회귀모형.html#cb46-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-37"><a href="자기회귀모형.html#cb46-37" aria-hidden="true" tabindex="-1"></a>plot_pacf(AR1_30, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">2</span>,<span class="dv">1</span>],title <span class="op">=</span><span class="st">&#39;AR1_30 PACF&#39;</span> )</span>
<span id="cb46-38"><a href="자기회귀모형.html#cb46-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-39"><a href="자기회귀모형.html#cb46-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-13.png" width="672" /></p>
<p>두 계열의 표본 ACF를 보면, AR(1)과정임에도 불구하고 두 계열 모두 래그 2 이상에서도 자기상관을 가지고 있음을 확인할 수 있다(?).</p>
<p>어떤 임의의 자료가 있을 때 이의 Sample ACF, Sample PACF가 위의 그림과 유사하다고 하자. 즉, 표본 ACF값이 상대적으로 부드럽게 감소하고(‘taper-off’), 표본 PACF 값은 래그 1 이후에도 0으로 갑자기 줄어드는 경우(‘cut-off after lag 1’)이다. 이 경우 우리는 임의의 자료가 AR(1)과정에서 생성된 것이라고 추측할 수 있으며, 이 자료를 AR(1)모형으로 표현하여 모형을 추정하게 되는 것이다.</p>
</div>
</div>
<div id="ar2-모형" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 4.3.2 AR(2) 모형<a href="자기회귀모형.html#ar2-모형" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-6" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> -<a href="자기회귀모형.html#section-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>AR(2)모형은 다음과 같다.</p>
<p><span class="math display">\[
x_t-\mu = \phi_1(x_{t-1} - \mu) + \phi_2(x_{t-2}-\mu)+a_t
\]</span></p>
<p>또는 래그연산자 <span class="math inline">\(L\)</span>을 사용하여 다음과 같이도 쓸 수 있다. 단, 이후 식들에서는 편의를 위해 <span class="math inline">\(\mu=0\)</span>을 가정한다.</p>
<p><span class="math display">\[
(1-\phi_1L-\phi_2L^2)(x_t-\mu)=\phi(L)x_t = a_t
\]</span></p>
<p>AR(1)과정과 동일한 방법으로 안정성 조건을 확인한다면, 다음과 같다.</p>
<p><span class="math display">\[
\phi_1 + \phi_2 &lt; 1\\
-\phi_1+ \phi_2 &lt; 1\\
-1&lt;\phi_2&lt;1
\]</span></p>
<p>AR(2)모형의 자기공분산을 계산하여보자.</p>
<p><span class="math display">\[
E(x_t,x_{t-k}) = \phi_1E(x_{t-1}x_{t-k})+\phi_1E(x_{t-2}x_{t-k})+E(a_tx_{t-k})\\ \gamma_k-\phi_1\gamma_{k-1}-\phi_2\gamma_{k-2}=E(a_tx_{t-k})\\
\quad \\
\gamma_0-\phi_1\gamma_1-\phi_2\gamma_2 = E(a_tx_{t-k}) = \sigma^2_a\\ \gamma_k-\phi_1\gamma_{k-1}-\phi_2\gamma_{k-2} = E(a_tx_{t-k}) = 0, \quad k = 1,2,\cdots
\]</span></p>
<p>따라서 AR(1)모형의 경우와 유사하게 AR(2)과정의 자기공분산 방정식 또한 자료생성과정과 같은 형태를 가짐을 알 수 있다.</p>
<div id="ar2모형의-자기상관함수acf" class="section level4 hasAnchor" number="6.3.1.1">
<h4><span class="header-section-number">6.3.1.1</span> AR(2)모형의 자기상관함수(ACF)<a href="자기회귀모형.html#ar2모형의-자기상관함수acf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>자기상관계수 방정식 또한 자기공분산 방정식과 같이 AR(2)자료 생성 과정과 같다.</p>
<p><span class="math display">\[
\gamma_k-\phi_1\gamma_{k-1}-\phi_2\gamma_{k-2} = 0 \\
(\gamma_k-\phi_1\gamma_{k-1}-\phi_2\gamma_{k-2})/\gamma_0 = 0/\gamma_0 \\ \rho_k-\phi_1\rho_{k-1}-\phi_2\rho_{k-2} = 0, \quad k=1,2,\cdots \\
\quad\\
\quad\\
\rho_1=\phi_1/(1-\phi_2) \\ \rho_2=\frac{\phi^2_1}{(1-\phi_2)}+\phi_2=\frac{\phi^2_1+\phi_2-\phi^2_2}{1-\phi_2}\\
(\because \rho*k=*\rho{-k})
\]</span></p>
<p>이때 <span class="math inline">\(\gamma_0(1-\phi_1\rho_1-\phi_2\rho_2)=\sigma^2_2\)</span>이므로 위에서 구한 <span class="math inline">\(\rho_1\)</span>와 <span class="math inline">\(\rho_2\)</span>를 대입하면 AR(2)과정을 따르는 <span class="math inline">\(x_t\)</span>의 분산<span class="math inline">\(\sigma^2_x=\gamma_0\)</span>는 다음과 같다.</p>
<p><span class="math display">\[
\gamma_0 = \sigma^2_x = (\frac{1-\phi_2}{1+\phi_2}) \cdot (\frac{\sigma^2_a}{(\phi_1+\phi_2-1)(\phi_2-\phi_1-1)})
\]</span></p>
</div>
<div id="ar2모형의-편자기상환상관함수partial-acf" class="section level4 hasAnchor" number="6.3.1.2">
<h4><span class="header-section-number">6.3.1.2</span> AR(2)모형의 편자기상환상관함수(Partial ACF)<a href="자기회귀모형.html#ar2모형의-편자기상환상관함수partial-acf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>AR(2)과정의 PACF는 다음과 같다.</p>
<p><span class="math display">\[
\phi_{11}=\rho_1=\frac{\phi_1}{1-\phi_2} \\
\phi_{22}=\frac{\rho_2-\rho^2_1}{1-\rho^2_1}=\phi_2 \\
\phi_{33}=0, \quad for \ k\ge 3
\]</span></p>
<p>###예제) AR(2)과정 : 시뮬레이션</p>
<p>다음 과정은 <span class="math inline">\((\phi_1,\phi_2) = (1.2,-0.5)\)</span>와 <span class="math inline">\((\phi_1,\phi_2) = (0.4,0.2)\)</span>의 모수를 갖는 AR(2)과정을 시뮬레이션하고 이들의 표본 ACF, PACF를 계산하는 코드이다.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="자기회귀모형.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.arima_process <span class="im">import</span> ArmaProcess</span>
<span id="cb47-2"><a href="자기회귀모형.html#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="자기회귀모형.html#cb47-3" aria-hidden="true" tabindex="-1"></a>plt.cla()</span>
<span id="cb47-4"><a href="자기회귀모형.html#cb47-4" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb47-5"><a href="자기회귀모형.html#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="자기회귀모형.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ar2_1 phi = 1.2,-0.5</span></span>
<span id="cb47-7"><a href="자기회귀모형.html#cb47-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb47-8"><a href="자기회귀모형.html#cb47-8" aria-hidden="true" tabindex="-1"></a>ar2_1_ar_parm <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.5</span>]) <span class="co"># 0.95를 넣기 위해서는 음수로 넣어야 하며, 1은 lag 0에서를 의미함.</span></span>
<span id="cb47-9"><a href="자기회귀모형.html#cb47-9" aria-hidden="true" tabindex="-1"></a>ar2_1_ma_parm <span class="op">=</span> np.array([<span class="dv">1</span>])</span>
<span id="cb47-10"><a href="자기회귀모형.html#cb47-10" aria-hidden="true" tabindex="-1"></a>AR2_1 <span class="op">=</span> ArmaProcess(ar2_1_ar_parm, ar2_1_ma_parm).generate_sample(nsample<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb47-11"><a href="자기회귀모형.html#cb47-11" aria-hidden="true" tabindex="-1"></a>plt.plot(AR2_1)</span>
<span id="cb47-12"><a href="자기회귀모형.html#cb47-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;AR(1)=1.2, AR(2)=-0.5&#39;</span>)</span>
<span id="cb47-13"><a href="자기회귀모형.html#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="자기회귀모형.html#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ar2_2 phi = 0.4, 0.2</span></span>
<span id="cb47-15"><a href="자기회귀모형.html#cb47-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb47-16"><a href="자기회귀모형.html#cb47-16" aria-hidden="true" tabindex="-1"></a>ar2_2_ar_parm <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.2</span>])</span>
<span id="cb47-17"><a href="자기회귀모형.html#cb47-17" aria-hidden="true" tabindex="-1"></a>ar2_2_ma_parm <span class="op">=</span> np.array([<span class="dv">1</span>])</span>
<span id="cb47-18"><a href="자기회귀모형.html#cb47-18" aria-hidden="true" tabindex="-1"></a>AR2_2 <span class="op">=</span> ArmaProcess(ar2_2_ar_parm, ar2_2_ma_parm).generate_sample(nsample<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb47-19"><a href="자기회귀모형.html#cb47-19" aria-hidden="true" tabindex="-1"></a>plt.plot(AR2_2 )</span>
<span id="cb47-20"><a href="자기회귀모형.html#cb47-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;AR(1)=0.4, AR(2)=0.2&#39;</span>)</span>
<span id="cb47-21"><a href="자기회귀모형.html#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="자기회귀모형.html#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="자기회귀모형.html#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co">#ar2_95 acf</span></span>
<span id="cb47-24"><a href="자기회귀모형.html#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="자기회귀모형.html#cb47-25" aria-hidden="true" tabindex="-1"></a>plot_acf(AR2_1, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">1</span>,<span class="dv">0</span>], title <span class="op">=</span><span class="st">&#39;AR(2)_1 ACF&#39;</span>)</span>
<span id="cb47-26"><a href="자기회귀모형.html#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="자기회귀모형.html#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co">#ar2_30 acf</span></span>
<span id="cb47-28"><a href="자기회귀모형.html#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="자기회귀모형.html#cb47-29" aria-hidden="true" tabindex="-1"></a>plot_acf(AR2_2, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">1</span>,<span class="dv">1</span>], title <span class="op">=</span><span class="st">&#39;AR(2)_2 ACF&#39;</span>)</span>
<span id="cb47-30"><a href="자기회귀모형.html#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="자기회귀모형.html#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co">#ar2_95 pacf</span></span>
<span id="cb47-32"><a href="자기회귀모형.html#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="자기회귀모형.html#cb47-33" aria-hidden="true" tabindex="-1"></a>plot_pacf(AR2_1, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">2</span>,<span class="dv">0</span>],  title <span class="op">=</span><span class="st">&#39;AR(2)_1 PACF&#39;</span>)</span>
<span id="cb47-34"><a href="자기회귀모형.html#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="자기회귀모형.html#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co">#ar2_30 pacf</span></span>
<span id="cb47-36"><a href="자기회귀모형.html#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="자기회귀모형.html#cb47-37" aria-hidden="true" tabindex="-1"></a>plot_pacf(AR2_2, lags<span class="op">=</span><span class="dv">40</span>, use_vlines<span class="op">=</span><span class="va">True</span>, zero <span class="op">=</span> <span class="va">False</span>, auto_ylims<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax[<span class="dv">2</span>,<span class="dv">1</span>],title <span class="op">=</span><span class="st">&#39;AR(2)_1 PACF&#39;</span> )</span>
<span id="cb47-38"><a href="자기회귀모형.html#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="자기회귀모형.html#cb47-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-15.png" width="672" /></p>
<p>두 시뮬레이션 모두 표본 PACF를 보면 래그 2 이후 모두 단절(cutt-off)되는 특성을 보이고 있다. 역으로 표본 PACF로 부터 AR(2)모형이 이 데이터들의 자료 생성 과정으로 적절한 후보임을 알 수도 있을 것이다.</p>
<p>또한 표본 ACF를 보면 점차 감소(taper-off)하는 모형을 가지는데 긴 래그에서 집단적으로 작지만 음의 계수를 띄고 있는 것을 확인할 수 있다. 이러한 AR(2)과정의 움직임을 ‘준사이클’(pseudo-cycle)이라고 부르기도 한다.</p>
</div>
</div>
</div>
<div id="p-차-자기회귀모형arp-모형" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 4.3.3 p-차 자기회귀모형(AR(p) 모형)<a href="자기회귀모형.html#p-차-자기회귀모형arp-모형" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-7" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> -<a href="자기회귀모형.html#section-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(p\)</span>-차 자기회귀 모형의 표현식은 다음과 같다.</p>
<p><span class="math display">\[
x_t = \phi_1x_{t-1}+\phi_2x_{t-2}+\cdots+\phi_px_{t-p}+a_t
\]</span></p>
<p>AR(p) 모형에서 공분산을 계산하면 다음과 같다.</p>
<p>$$
<em>k=E(x_tx</em>{t-k})\
=<em>1E(x</em>{t-1}x_{t-k})+<em>2E(x</em>{t-2}x_{t-k})++<em>pE(x</em>{t-p}x_{t-k})+E(a_tx_{t-k}) \
=<em>1</em>{k-1}+<em>2</em>{k-2}++<em>p</em>{k-p} for  k&gt;0 \
<em>0 = ^p</em>{j=1}_j_j+^2_a, for  k=0 (<em>k=</em>{-k})</p>
<p>$$</p>
<div id="arp모형의-자기상관함수acf" class="section level4 hasAnchor" number="6.4.1.1">
<h4><span class="header-section-number">6.4.1.1</span> AR(p)모형의 자기상관함수(ACF)<a href="자기회귀모형.html#arp모형의-자기상관함수acf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>ACF는 지수적으로 감소하는 항 또는 sin곡선들이 서로 혼합된 형태로 차차 감솨하는 모양의 띄게 된다. 일부 근이 복소수인 경우 자기상관함수는 점차 감소하는 sin 곡선 모양을 한다.</p>
</div>
<div id="arp모형의-편자기상관함수pacf" class="section level4 hasAnchor" number="6.4.1.2">
<h4><span class="header-section-number">6.4.1.2</span> AR(p)모형의 편자기상관함수(PACF)<a href="자기회귀모형.html#arp모형의-편자기상관함수pacf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>AR(p)모형의 PACF <span class="math inline">\(\phi_{kk}\)</span>는 래그 <span class="math inline">\(p\)</span>이후에는 사라지게 된다.</p>
<p><strong>즉 AR(p)모형의 경우 ACF는 점차적으로 감소하는 반면, PACF는 래그</strong> <span class="math inline">\(p\)</span> 이후에 0이 되는 특성이 있다.</p>
</div>
</div>
</div>
<div id="arp-모형의-mainfty-모형으로의-전환" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> 4.3.4 AR(p) 모형의 MA(<span class="math inline">\(\infty\)</span>) 모형으로의 전환<a href="자기회귀모형.html#arp-모형의-mainfty-모형으로의-전환" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-8" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> -<a href="자기회귀모형.html#section-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>다음과 같은 안정적 <span class="math inline">\(p\)</span>-차 자기회귀 모형을 생각해보자.</p>
<p><span class="math display">\[
(1-\phi_1L-\phi_1L-\cdots-\phi_1L)x_t = a_t \\
\phi(L)x_t = a_t
\]</span></p>
<p>이를 다음과 같이 다시 쓸 수 있다.</p>
<p><span class="math display">\[
x_t = a_t/\phi(L) = \psi(L)a_t
\]</span></p>
<p>단, <span class="math inline">\(\psi(L) = (1+\psi_1L+\psi_2L^2+\cdots)\)</span>로 우리고 구하고자 하는 래그 다항식으며 다음을 만족하게 된다.</p>
<p><span class="math display">\[
\phi(L)\psi(L)=1
\]</span></p>
<div id="충격반응함수impulse-response-function" class="section level4 hasAnchor" number="6.5.1.1">
<h4><span class="header-section-number">6.5.1.1</span> 충격반응함수(impulse response function)<a href="자기회귀모형.html#충격반응함수impulse-response-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>계수 <span class="math inline">\(\psi_k\)</span>는 <span class="math inline">\(t\)</span>-시점의 충격 <span class="math inline">\(a_t\)</span>가 <span class="math inline">\((t+k)\)</span>-기의 <span class="math inline">\(x_t\)</span>에 미치는 영향을 측정한다. 즉, 안정적 확률과정의 경우 <span class="math inline">\(\partial x_{t-k}/\partial a_t = \psi_k\)</span>가 성립한다. 이를 ‘충격반응함수’(impulse response function)라고 하며 AR(p)모형의 계수 자체로는 이것을 계산할 수 없고 이를 MA(<span class="math inline">\(\infty\)</span>)모형으로 전환하고 이때의 가중치 <span class="math inline">\(\psi\)</span>를 계산해야 할 필요가 있다.</p>
</div>
</div>
<div id="diy-예제-충격반응함수" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> diy 예제) 충격반응함수<a href="자기회귀모형.html#diy-예제-충격반응함수" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>statsmodels에서는 AR에 대해서는 충격반응함수를 제공하고 있지 않습니다. ARIMA 함수를 가져와서 사용하겠습니다. 다음은 AR(2)모형의 예제입니다.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="자기회귀모형.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb48-2"><a href="자기회귀모형.html#cb48-2" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> sm.tsa.arima.ARIMA(AR2_2, order<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>)).fit() <span class="co">#p=2 d = 0 q = 0 임으로 AR(2)</span></span>
<span id="cb48-3"><a href="자기회귀모형.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(res.summary())</span></span>
<span id="cb48-4"><a href="자기회귀모형.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res.impulse_responses(steps<span class="op">=</span><span class="dv">10</span>))</span></code></pre></div>
<pre><code>## [1.         0.32593335 0.34933405 0.19309451 0.14785957 0.09513393
##  0.06695221 0.04494916 0.03092661 0.02100722 0.01436526]</code></pre>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="기초-개념.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="이동평균-모형.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/4_안정적_시계열모형의_추정과_예측.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
