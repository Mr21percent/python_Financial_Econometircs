<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 추세와 단위근 | index</title>
  <meta name="description" content="4 추세와 단위근 | index" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="4 추세와 단위근 | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 추세와 단위근 | index" />
  
  
  

<meta name="author" content="mr21percent" />


<meta name="date" content="2022-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="불안정적-시계열모형의-추정과-예측.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">파이썬을 활용한 금융시계열분석</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 시작에 앞서</a></li>
<li class="chapter" data-level="2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html"><i class="fa fa-check"></i><b>2</b> 안정적 시계열모형의 추정과 예측</a>
<ul>
<li class="chapter" data-level="2.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#시작에-앞서-python을-사용하기-위한-설정"><i class="fa fa-check"></i><b>2.1</b> 시작에 앞서 python을 사용하기 위한 설정</a></li>
<li class="chapter" data-level="2.2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#일반적인-시계열-분석-과정의-이해"><i class="fa fa-check"></i><b>2.2</b> 일반적인 시계열 분석 과정의 이해</a></li>
<li class="chapter" data-level="2.3" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#기초-개념"><i class="fa fa-check"></i><b>2.3</b> 기초 개념</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#확률과정"><i class="fa fa-check"></i><b>2.3.1</b> 확률과정</a></li>
<li class="chapter" data-level="2.3.2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#안정성-자기공분산-및-자기-상관"><i class="fa fa-check"></i><b>2.3.2</b> 안정성, 자기공분산 및 자기 상관</a></li>
<li class="chapter" data-level="2.3.3" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#편자기상관"><i class="fa fa-check"></i><b>2.3.3</b> 편자기상관</a></li>
<li class="chapter" data-level="2.3.4" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#월드분해정리와-선형필터"><i class="fa fa-check"></i><b>2.3.4</b> 월드분해정리와 선형필터</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#자기회귀모형"><i class="fa fa-check"></i><b>2.4</b> 자기회귀모형</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#예시-안정성-조건-확인"><i class="fa fa-check"></i><b>2.4.1</b> 예시 (안정성 조건 확인)</a></li>
<li class="chapter" data-level="2.4.2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#ar1-모형"><i class="fa fa-check"></i><b>2.4.2</b> AR(1) 모형</a></li>
<li class="chapter" data-level="2.4.3" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#ar2-모형"><i class="fa fa-check"></i><b>2.4.3</b> AR(2) 모형</a></li>
<li class="chapter" data-level="2.4.4" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#p-차-자기회귀모형arp-모형"><i class="fa fa-check"></i><b>2.4.4</b> p-차 자기회귀모형(AR(p) 모형)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#이동평균-모형"><i class="fa fa-check"></i><b>2.5</b> 이동평균 모형</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#가역성-조건"><i class="fa fa-check"></i><b>2.5.1</b> 가역성 조건</a></li>
<li class="chapter" data-level="2.5.2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#ma1-모형"><i class="fa fa-check"></i><b>2.5.2</b> MA(1) 모형</a></li>
<li class="chapter" data-level="2.5.3" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#ma2-모형"><i class="fa fa-check"></i><b>2.5.3</b> MA(2) 모형</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#q-차-이동평균모형maq모형"><i class="fa fa-check"></i><b>2.6</b> q-차 이동평균모형(MA(q)모형)</a></li>
<li class="chapter" data-level="2.7" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#자기회귀---이동평균모형armapq-models"><i class="fa fa-check"></i><b>2.7</b> 자기회귀 - 이동평균모형(ARMA(p,q) models)</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#arma11-과정"><i class="fa fa-check"></i><b>2.7.1</b> ARMA(1,1) 과정</a></li>
<li class="chapter" data-level="2.7.2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#armapq-모형"><i class="fa fa-check"></i><b>2.7.2</b> ARMA(p,q) 모형</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#적정-armapq모형-선정-절차---diagnostic-checking"><i class="fa fa-check"></i><b>2.8</b> 적정 ARMA(p,q)모형 선정 절차 - Diagnostic Checking</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#diy-예제-결과에서-확인해보기"><i class="fa fa-check"></i><b>2.8.1</b> diy 예제) 결과에서 확인해보기</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#arma-모형의-예측"><i class="fa fa-check"></i><b>2.9</b> ARMA 모형의 예측</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#arma-pq-모형의-예측의-기본원리"><i class="fa fa-check"></i><b>2.9.1</b> ARMA (p,q) 모형의 예측의 기본원리</a></li>
<li class="chapter" data-level="2.9.2" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#예측오차"><i class="fa fa-check"></i><b>2.9.2</b> 예측오차</a></li>
<li class="chapter" data-level="2.9.3" data-path="안정적-시계열모형의-추정과-예측.html"><a href="안정적-시계열모형의-추정과-예측.html#예제-원-달러-환율변화율의-예측"><i class="fa fa-check"></i><b>2.9.3</b> 예제) 원-달러 환율변화율의 예측</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html"><i class="fa fa-check"></i><b>3</b> 불안정적 시계열모형의 추정과 예측</a>
<ul>
<li class="chapter" data-level="3.1" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#시작에-앞서-python을-사용하기-위한-설정-1"><i class="fa fa-check"></i><b>3.1</b> 시작에 앞서 python을 사용하기 위한 설정</a></li>
<li class="chapter" data-level="3.2" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#불안정시계열모형"><i class="fa fa-check"></i><b>3.2</b> 불안정시계열모형</a></li>
<li class="chapter" data-level="3.3" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#확률보행모형"><i class="fa fa-check"></i><b>3.3</b> 확률보행모형</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#예제-확률보행과정-sample-acf와-sample-pacf"><i class="fa fa-check"></i><b>3.3.1</b> 예제) 확률보행과정 Sample ACF와 Sample PACF</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#integrated-moving-averageima모형"><i class="fa fa-check"></i><b>3.4</b> Integrated Moving-Average(IMA)모형</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#ima11과정의-sample-acf와-sample-pacf"><i class="fa fa-check"></i><b>3.4.1</b> IMA(1,1)과정의 Sample ACF와 Sample PACF</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#arimapdq과정"><i class="fa fa-check"></i><b>3.5</b> ARIMA(p,d,q)과정</a></li>
<li class="chapter" data-level="3.6" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#베버리지-넬슨-분해"><i class="fa fa-check"></i><b>3.6</b> 베버리지-넬슨 분해</a></li>
<li class="chapter" data-level="3.7" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#hodric-prescott-필터"><i class="fa fa-check"></i><b>3.7</b> Hodric-Prescott 필터</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#예제hp-필터-분해"><i class="fa fa-check"></i><b>3.7.1</b> 예제)HP 필터 분해</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#불안정시계열의-예측"><i class="fa fa-check"></i><b>3.8</b> 불안정시계열의 예측</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#arimapdq모형의-mmse-예측"><i class="fa fa-check"></i><b>3.8.1</b> ARIMA(p,d,q)모형의 MMSE 예측</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="불안정적-시계열모형의-추정과-예측.html"><a href="불안정적-시계열모형의-추정과-예측.html#python을을-이용한-예측-예제"><i class="fa fa-check"></i><b>3.9</b> Python을을 이용한 예측 예제</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="추세와-단위근.html"><a href="추세와-단위근.html"><i class="fa fa-check"></i><b>4</b> 추세와 단위근</a>
<ul>
<li class="chapter" data-level="4.1" data-path="추세와-단위근.html"><a href="추세와-단위근.html#시작에-앞서-python을-사용하기-위한-설정-2"><i class="fa fa-check"></i><b>4.1</b> 시작에 앞서 python을 사용하기 위한 설정</a></li>
<li class="chapter" data-level="4.2" data-path="추세와-단위근.html"><a href="추세와-단위근.html#추세모형"><i class="fa fa-check"></i><b>4.2</b> 추세모형</a></li>
<li class="chapter" data-level="4.3" data-path="추세와-단위근.html"><a href="추세와-단위근.html#dickey-fuller-단위근-검정"><i class="fa fa-check"></i><b>4.3</b> Dickey-Fuller 단위근 검정</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="추세와-단위근.html"><a href="추세와-단위근.html#예제-kospi-주가지수의-adf-검정"><i class="fa fa-check"></i><b>4.3.1</b> 예제) KOSPI 주가지수의 ADF-검정</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="추세와-단위근.html"><a href="추세와-단위근.html#필립스-페론phillips-perron-단위근-검정"><i class="fa fa-check"></i><b>4.4</b> 필립스-페론(Phillips-Perron) 단위근 검정</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="추세와-단위근.html"><a href="추세와-단위근.html#예제-phillips-perron을-활용한-kospi-자료의-단위근-검정"><i class="fa fa-check"></i><b>4.4.1</b> 예제) Phillips-Perron을 활용한 Kospi 자료의 단위근 검정</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="추세와-단위근.html"><a href="추세와-단위근.html#유사회귀분석"><i class="fa fa-check"></i><b>4.5</b> 유사회귀분석</a></li>
<li class="chapter" data-level="4.6" data-path="추세와-단위근.html"><a href="추세와-단위근.html#단위근이-있는-시계열의-유사추세-및-사이클"><i class="fa fa-check"></i><b>4.6</b> 단위근이 있는 시계열의 유사추세 및 사이클</a></li>
<li class="chapter" data-level="4.7" data-path="추세와-단위근.html"><a href="추세와-단위근.html#시간추세-안정적-시계열과-차분안정적-시계열의-선택문제"><i class="fa fa-check"></i><b>4.7</b> 시간추세 안정적 시계열과 차분안정적 시계열의 선택문제</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">index</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="추세와-단위근" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> 추세와 단위근<a href="추세와-단위근.html#추세와-단위근" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="시작에-앞서-python을-사용하기-위한-설정-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 시작에 앞서 python을 사용하기 위한 설정<a href="추세와-단위근.html#시작에-앞서-python을-사용하기-위한-설정-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>다음은 python을 불러오기 위한 것입니다. 본인의 파이썬 경로를 넣으실 수도 있겠지만, 편의를 위하여 포함되어 있는 파일을 사용하시길 추천드립니다.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="추세와-단위근.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb151-2"><a href="추세와-단위근.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arch</span>
<span id="cb151-3"><a href="추세와-단위근.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb151-4"><a href="추세와-단위근.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb151-5"><a href="추세와-단위근.html#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb151-6"><a href="추세와-단위근.html#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<div id="추세모형" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 추세모형<a href="추세와-단위근.html#추세모형" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>추세란 보통 어떤 시계열이 단기보다는 장기적으로 움직이는 패턴을 말한다.</p>
<p>시계열 분석에서 추세는 일정한 모형을 전제로 하고 정의한다. 예를 들어 ARMA 유형의 시계열모형을 전제로 추세를 정의할 수도 있고, 성장곡선과 같은 비선형모형을 전제로 할 수도 있다. 시계열모형에서 어떻게 추세를 모형화하는가는 장기 out-of-sample 예측에 있어서 지배적인 결과를 초래하므로 실제로 데이터의 모형을 설정하기 전에 추세의 특성을 정확히 파악할 필요가 있다. 여기에서는 결정적 추세모형(deterministic trend model; DT)와 확률추세모형(stochastic trend model; ST)을 설명하기로 한다.</p>
<p>예를 들어, 시계열 <span class="math inline">\(x_t\)</span>가 <span class="math inline">\(\alpha + \beta t\)</span>의 선형시간추세를 가지고 있을 때 이 추세로부터의 편차가 1-차 자기회귀모형을 따르는 경우를 생각해 보자.</p>
<p><span class="math display">\[
x_t-\alpha - \beta t = \phi(x_{t-1}-\alpha-\beta(t-1))+a_t, \quad a_t \sim N(0,\sigma^2_\alpha)
\]</span></p>
<p>단, t는 차분이 1인 시간 인덱스를 나타낸다. (1,2,3 …) 위 식은 다음과 같이 표현할 수 있다.</p>
<p><span class="math display">\[
x_t = [(1-\phi)\alpha + \phi \beta]+(1-\phi)\beta t + \phi x_{t-1} + a_t \\
= \alpha^* + \beta^* t + \phi x_{t-1} + a_t
\]</span></p>
<p><span class="math inline">\(z_t = x_t - \alpha - \beta t\)</span>라고 정의했을 때 식을 다음과 같이 변경할 수 있을 것이다.</p>
<p><span class="math display">\[
z_t = \phi^t z_0 + \sum^{t}_{i-1}\phi^{t-i}a_i
\]</span></p>
<p><span class="math inline">\(z_0\)</span>은 임의의 초기값이다. 만일 <span class="math inline">\(|\phi|&lt;1\)</span>이면 초기값 <span class="math inline">\(z_0\)</span>의 영향은 점차 감소할 것이며 최근의 충격은 과거의 충격보다 <span class="math inline">\(z_t\)</span>에 더 큰 영향을 미칠 것이다. 그러나 특정시점에서의 충격은 장기적으로 사라지게 될 것이다. 즉, DT모형에서는 <span class="math inline">\(x_t\)</span>가 이의 평균 <span class="math inline">\(\alpha + \beta t\)</span>로 회귀하는 특성을 갖게 된다.</p>
<p>시간추세모형은 물론 시간에 대해서 선형일 필요는 없다. 예를 들어, 성장곡선모형에 많이 사용되는 Gompertz 성장곡선모형은 다음과 같은 비선형 추세를 갖는다.</p>
<p><span class="math display">\[
x_t = \alpha exp ^{-\beta exp(-\gamma t)}+ a_t, \quad a_t \sim N(0,\sigma^2_a)
\]</span></p>
<p>만약 <span class="math inline">\(\phi = 1\)</span>이면 다음과 같은 확률보행과정(random walk process)이 된다.</p>
<p><span class="math display">\[
x_t = \beta + x_{t-1} + a_t
\]</span></p>
<p>이 경우 <span class="math inline">\(z_t = z_0 + \sum^{t}_{i=1}a_i\)</span>가 되며 <span class="math inline">\(x_t\)</span>는 다음과 같이 표현할 수 있다.</p>
<p><span class="math display">\[
x_t = x_0 + \beta t + \sum^t_{i=1} a_i
\]</span></p>
<p>식에서 <span class="math inline">\(\sum^t_{i=1} a_i\)</span> 항을 확률 추세(stochastic trend)라고 하고 이 때의 <span class="math inline">\(x_t\)</span>를 ST시계열이라고 한다. 확률추세항을 보면 <span class="math inline">\(x_t\)</span>를 왜 적분과정이라고 부르는지 알 수 있다. 확률보행과정은 한 번 차분하면 안정적이기 때문에 1-차 적분과정이라고 부르고 기호로는 보통 I(1)로 표시한다.</p>
<p>ST모형에서는 현재뿐만 아니라 아주 오래 전의 충격도 동일하게 <span class="math inline">\(x_t\)</span>에 영원한 영향을 미친다. 물론 시간추세항 <span class="math inline">\(\beta t\)</span>가 포함되어 있으나 <span class="math inline">\(\beta\)</span>의 크기가 <span class="math inline">\(\sigma^2_\alpha\)</span> 보다 상대적으로 작으면 <span class="math inline">\(x_t\)</span>의 움직임은 주로 확률추세의 의해 좌우되며 시간추세에서 벗어난 경우 그 상태에서 상당기간 머무는 특성이 있다. 만일 <span class="math inline">\(\beta\)</span>가 0이면 <span class="math inline">\(x_t\)</span>는 어떠한 평균우로도 회귀하지 않을 수 있다. DT모형의 평균회귀성향과 ST모형의 표류성향은 장기예측에 있어서 후자의 정확도가 훨씬 떨어질 것임을 시사하고 있다.</p>
<p>우리가 보통 분석하고 예측하는 금융 및 경제 시계열들은 대부분 I(1) 과정이다.</p>
<p>확률 추세를 가지고 있는 임의의 시계열이 있다고 할 때 두드러지는 특성 중 하나는 이의 AR 표현식이 적어도 하나의 (1-L)항을 갖는다는 것이다. 즉,</p>
<p><span class="math display">\[
\phi_p(L) = (1-\phi_1 L - \cdots - \phi_p L^P) \\
= (1-\alpha_1 L - \cdots - \alpha_{p-1}L^{p-1})(1-L) \\
= \phi_{p-1}(L)(1-L)
\]</span></p>
<p>만약 위의 AR(p)모형이 I(1)과정이라면</p>
<p><span class="math display">\[
\phi_p(1) = 1-\phi_1 - \cdots - \phi_p = 0
\]</span></p>
<p>이 성립한다.</p>
<p>이를 바탕으로 <span class="math inline">\(x_t\)</span>가 안정적 AR(2)과정인지 아니면 확률 추세를 갖는 I(1)과정인지 검정할 수 있는 방법이 있음을 알 수 있다. 즉, <span class="math inline">\(\phi_1 + \phi_2 &lt; 1\)</span> 또는 <span class="math inline">\(\phi_1 + \phi_2 = 1\)</span>를 검정하면 될 것이다. 그러나 적분된 자료를 분석하는 경우 문제는 유한한 표본을 가지고 <span class="math inline">\(\phi\)</span>를 추정해야 하며 이 때 적용하는 통계적 추론 절차는 전통적인 t-검정과는 차이가 있다는 점이다. 이러한 검정방법을 다루는 분야를 보통 단위근 검정(unit root test)이라고 부른다.</p>
</div>
<div id="dickey-fuller-단위근-검정" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Dickey-Fuller 단위근 검정<a href="추세와-단위근.html#dickey-fuller-단위근-검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>시계열에 단위근이 있는지를 검정하는데 왜 일반적인 통계적 추론절차를 사용할 수 없는지를 이해하기 위하여 다음과 같이 단순한 AR(1)모형에 OLS를 적용하고 회귀계수에 대한 가설검정을 수행하는 경우를 생각해보자.</p>
<p><span class="math display">\[
x_t = \alpha x_{t-1} + u_t, \quad u_t \sim i.i.d. (0,\sigma^2_u)
\]</span></p>
<p>만일 위의 식에서 계수 <span class="math inline">\(\alpha\)</span>의 참값이 절대값으로 1보다 작은 경우 일반적인 점근분포이론(asymptotics)에 의하면 OLS추정량 <span class="math inline">\(\hat{\alpha}\)</span>은 다음과 같은 점근적 정규분포를 갖는다.</p>
<p><span class="math display">\[
\sqrt{T}(\hat{\alpha}-\alpha) \xrightarrow[]{a} N(0, [\sigma^2_u/(1-\alpha^2)]) = N(0, 1- \alpha^2)
\]</span></p>
<p>단, 꺾은 괄호 안의 값은 AR(1)과정의 특성에서 배운 것처럼 <span class="math inline">\(x_t\)</span>과정의 분산에 불과하다. 만일 <span class="math inline">\(|\alpha|&lt;1\)</span>이면 통상의 통계적 검정절차를 따라 t-검정을 수행할 수 있다.</p>
<p>그러나 귀무가설이 <span class="math inline">\(H_0:\alpha = 1\)</span>, 즉 <span class="math inline">\(x_t\)</span>가 I(1)인 적분과정이면 귀무가설하에서 식의 분산은 0이 된다. 즉, <span class="math inline">\(\hat{\alpha}\)</span>의 점근분포는 다음과 같이 0이라는 한 점으로 모두 귀착되게 된다.</p>
<p><span class="math display">\[
\sqrt{T}(\hat{\alpha} - 1 ) \xrightarrow{a} 0 \qquad \cdots (1)
\]</span></p>
<p>따라서 우리가 관심이 있는 귀무가설 <span class="math inline">\(H_0 : \alpha = 1\)</span>하에서 의미가 있는 통계적 가설검정을 할 수 없는 상황이 발생하는 것이다.</p>
<p>이러한 경우 Dickey와 Fuller(이하 DF로 약칭)는 단위근 검정을 위하여 다음과 같은 통계량을 계산하고 Fuller(1976)의 table을 사용하여 가설검정 할 것을 권고하고 있다. (표를 직접적으로 사용하지 않을 것이기에 첨부하지 않음)</p>
<p><span class="math display">\[
T(\hat{\alpha}-1) = T^{-1} \sum^{T}_{t=1}x_{t-1}(x_t-x_{t-1})/T^{-2}  \sum^{T}_{t=1}x^2_{t-1} \qquad \cdots (2)\\
t = (\sum x^2_{t-1})^{1/2}(\hat{\alpha}-1)/S \qquad \cdots (3)
\]</span>
단, <span class="math inline">\(S^2 = T^{-1}\sum(x_t-\hat{\alpha}x_{t-1})^2\)</span>이고 <span class="math inline">\(\hat{\alpha}\)</span>는 OLS추정량을 나타낸다.</p>
<p>즉, <span class="math inline">\(\hat{\alpha} = \frac{\sum^{T}_{t=1}x_{t-1}x_t}{\sum^{T}_{t=1}x_{t-1}^2}\)</span></p>
<p>식 (1)에서 <span class="math inline">\(T(\hat{\alpha}-1)\)</span>의 1은 단위근 귀무가설하에서의 <span class="math inline">\(\alpha\)</span>값이고 식 (3)에서 등호 왼쪽의 t는 통상의 t-통계량을 나타낸다. DF에 의하면 식 (1)과 같이 <span class="math inline">\(\sqrt{T}\)</span>를 곱하는 대신 식 (2)처럼 <span class="math inline">\(T\)</span>를 곱하면 통계량 <span class="math inline">\(T(\hat{\alpha}-1)\)</span>의 분산은 0으로 모두 귀착하지 않고 어떤 극한분포(limiting distribution)가 존재한다는 것이다. 이 극한분포를 이용하여 <span class="math inline">\(\alpha\)</span>가 1인가 하는 귀무가설을 검정할 수 있드는 것이 DF 단위근 검정의 주요 내용이다. 다만, <span class="math inline">\(T(\hat{\alpha}-1)\)</span>의 극한분포는 좌우대칭적인 분포가 아니라 음의 비대칭성(skewed to the left)을 띈다.</p>
<p>DF-검정은 다음과 같은 식에서 <span class="math inline">\(\rho=0\)</span>인지를 검정하는 것과 같다.</p>
<p><span class="math display">\[
\Delta x_t = \mu + \rho x_{t-1} + \beta \cdot (t-(T/2))+u_t
\]</span></p>
<p>그러나 원래의 자료는 보다 일반적인 AR(p)모형에서 생성된 경우를 생각할 수 있다. p-차의 AR과정에 단위근이 있으면 표현식에는 (p-1)-개의 <span class="math inline">\(\Delta x_t\)</span>의 래그항들이 나타나게 된다. <strong>‘확장DF-검정’(augmented DF 검정)</strong> 또는 줄여서 <strong>‘ADF-검정’</strong>은 누락된 AR 파라미터의 효과를 다음과 같은 모형설정을 통하여 고려하고 있다.</p>
<p><span class="math display">\[
\Delta x_t = \mu + \rho x_{t-1} + \beta (t-(T/2)) + \delta_1\Delta x_{t-1} + \cdots + \delta_{p-1}\Delta x_{t-p+1} + u_t
\]</span></p>
<p>이 경우에도 귀무가설은 <span class="math inline">\(H_0 : \rho = 0\)</span> 또는 <span class="math inline">\(H_0 : \rho = 0, \beta = 0\)</span>이다. 물론 ARMA(p,q) 모형은 적절한 AR모형으로 근사할 수 있으므로 <span class="math inline">\(\Delta x_{t-i}\)</span>항들을 충분히 오른쪽에 추가함으로써 검정할 수 있게 된다. Said and Dickey(1984)는 p를 충분히 크게 설정할 것을 권하고 있다. 실증 분석에서는 <span class="math inline">\(\Delta x_{t-i}\)</span> 추가해 가면서 유의적인 항이 어디까지인가를 살펴보고 p를 정하기도 한다.</p>
<div id="예제-kospi-주가지수의-adf-검정" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> 예제) KOSPI 주가지수의 ADF-검정<a href="추세와-단위근.html#예제-kospi-주가지수의-adf-검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ADF검정을 이용하여 자연대수를 취한 KOSPI 주가지수에 단위근이 존재하는지 살펴보자. 기간은 2019/01/05부터 2021/12/28까지 이다.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="추세와-단위근.html#cb152-1" aria-hidden="true" tabindex="-1"></a>kospi <span class="op">=</span> yf.download(<span class="st">&quot;^KS11&quot;</span>,start<span class="op">=</span><span class="st">&quot;2019-01-05&quot;</span>, end<span class="op">=</span><span class="st">&quot;2021-12-28&quot;</span>)</span></code></pre></div>
<pre><code>## 
[*********************100%***********************]  1 of 1 completed</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="추세와-단위근.html#cb154-1" aria-hidden="true" tabindex="-1"></a>plt.cla()</span>
<span id="cb154-2"><a href="추세와-단위근.html#cb154-2" aria-hidden="true" tabindex="-1"></a>kospi[<span class="st">&quot;Adj Close&quot;</span>].plot.line()</span>
<span id="cb154-3"><a href="추세와-단위근.html#cb154-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="main-files/figure-html/unnamed-chunk-48-1.png" width="1440" /></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="추세와-단위근.html#cb155-1" aria-hidden="true" tabindex="-1"></a>kospi</span></code></pre></div>
<pre><code>##                    Open         High  ...    Adj Close  Volume
## Date                                  ...                     
## 2019-01-07  2034.239990  2048.060059  ...  2037.099976  440200
## 2019-01-08  2038.680054  2042.699951  ...  2025.270020  397800
## 2019-01-09  2034.189941  2068.229980  ...  2064.709961  386200
## 2019-01-10  2065.729980  2072.810059  ...  2063.280029  382900
## 2019-01-11  2070.360107  2076.989990  ...  2075.570068  380100
## ...                 ...          ...  ...          ...     ...
## 2021-12-21  2981.669922  2984.560059  ...  2975.030029  410500
## 2021-12-22  2993.500000  3000.790039  ...  2984.479980  461400
## 2021-12-23  2998.020020  3000.699951  ...  2998.169922  483300
## 2021-12-24  3009.479980  3025.770020  ...  3012.429932  537500
## 2021-12-27  3013.939941  3017.310059  ...  2999.550049  475000
## 
## [736 rows x 6 columns]</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="추세와-단위근.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> adfuller</span>
<span id="cb157-2"><a href="추세와-단위근.html#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="추세와-단위근.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adf_test(timeseries):</span>
<span id="cb157-4"><a href="추세와-단위근.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Results of Dickey-Fuller Test:&quot;</span>)</span>
<span id="cb157-5"><a href="추세와-단위근.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    dftest <span class="op">=</span> adfuller(timeseries, autolag<span class="op">=</span><span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb157-6"><a href="추세와-단위근.html#cb157-6" aria-hidden="true" tabindex="-1"></a>    dfoutput <span class="op">=</span> pd.Series(</span>
<span id="cb157-7"><a href="추세와-단위근.html#cb157-7" aria-hidden="true" tabindex="-1"></a>        dftest[<span class="dv">0</span>:<span class="dv">4</span>],</span>
<span id="cb157-8"><a href="추세와-단위근.html#cb157-8" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[</span>
<span id="cb157-9"><a href="추세와-단위근.html#cb157-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Test Statistic&quot;</span>,</span>
<span id="cb157-10"><a href="추세와-단위근.html#cb157-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;p-value&quot;</span>,</span>
<span id="cb157-11"><a href="추세와-단위근.html#cb157-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;#Lags Used&quot;</span>,</span>
<span id="cb157-12"><a href="추세와-단위근.html#cb157-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Number of Observations Used&quot;</span>,</span>
<span id="cb157-13"><a href="추세와-단위근.html#cb157-13" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb157-14"><a href="추세와-단위근.html#cb157-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb157-15"><a href="추세와-단위근.html#cb157-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> dftest[<span class="dv">4</span>].items():</span>
<span id="cb157-16"><a href="추세와-단위근.html#cb157-16" aria-hidden="true" tabindex="-1"></a>        dfoutput[<span class="st">&quot;Critical Value (</span><span class="sc">%s</span><span class="st">)&quot;</span> <span class="op">%</span> key] <span class="op">=</span> value</span>
<span id="cb157-17"><a href="추세와-단위근.html#cb157-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dfoutput)</span>
<span id="cb157-18"><a href="추세와-단위근.html#cb157-18" aria-hidden="true" tabindex="-1"></a>adf_test(kospi[<span class="st">&quot;Adj Close&quot;</span>])</span></code></pre></div>
<pre><code>## Results of Dickey-Fuller Test:
## Test Statistic                  -0.768964
## p-value                          0.828069
## #Lags Used                       2.000000
## Number of Observations Used    733.000000
## Critical Value (1%)             -3.439303
## Critical Value (5%)             -2.865491
## Critical Value (10%)            -2.568874
## dtype: float64</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="추세와-단위근.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adf_test_by_21(timeseries, maxlag): <span class="co">#none ResultsStore</span></span>
<span id="cb159-2"><a href="추세와-단위근.html#cb159-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Results of Dickey-Fuller Test:&quot;</span>)</span>
<span id="cb159-3"><a href="추세와-단위근.html#cb159-3" aria-hidden="true" tabindex="-1"></a>    dftest <span class="op">=</span> adfuller(timeseries, maxlag<span class="op">=</span>maxlag, autolag<span class="op">=</span><span class="st">&quot;AIC&quot;</span>, regresults <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb159-4"><a href="추세와-단위근.html#cb159-4" aria-hidden="true" tabindex="-1"></a>    dfoutput <span class="op">=</span> pd.Series(</span>
<span id="cb159-5"><a href="추세와-단위근.html#cb159-5" aria-hidden="true" tabindex="-1"></a>        dftest[<span class="dv">0</span>:<span class="dv">2</span>],</span>
<span id="cb159-6"><a href="추세와-단위근.html#cb159-6" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[</span>
<span id="cb159-7"><a href="추세와-단위근.html#cb159-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Test Statistic&quot;</span>,</span>
<span id="cb159-8"><a href="추세와-단위근.html#cb159-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;p-value&quot;</span>,</span>
<span id="cb159-9"><a href="추세와-단위근.html#cb159-9" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb159-10"><a href="추세와-단위근.html#cb159-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb159-11"><a href="추세와-단위근.html#cb159-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> dftest[<span class="dv">2</span>].items():</span>
<span id="cb159-12"><a href="추세와-단위근.html#cb159-12" aria-hidden="true" tabindex="-1"></a>        dfoutput[<span class="st">&quot;Critical Value (</span><span class="sc">%s</span><span class="st">)&quot;</span> <span class="op">%</span> key] <span class="op">=</span> value</span>
<span id="cb159-13"><a href="추세와-단위근.html#cb159-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dfoutput)</span>
<span id="cb159-14"><a href="추세와-단위근.html#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dftest[<span class="dv">3</span>].resols.summary())</span>
<span id="cb159-15"><a href="추세와-단위근.html#cb159-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-16"><a href="추세와-단위근.html#cb159-16" aria-hidden="true" tabindex="-1"></a>adf_test_by_21(kospi[<span class="st">&quot;Adj Close&quot;</span>],<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Results of Dickey-Fuller Test:
## Test Statistic         -0.768964
## p-value                 0.828069
## Critical Value (1%)    -3.439303
## Critical Value (5%)    -2.865491
## Critical Value (10%)   -2.568874
## dtype: float64
##                             OLS Regression Results                            
## ==============================================================================
## Dep. Variable:                      y   R-squared:                       0.008
## Model:                            OLS   Adj. R-squared:                  0.004
## Method:                 Least Squares   F-statistic:                     1.985
## Date:                   일, 09 10 2022   Prob (F-statistic):              0.115
## Time:                        20:11:16   Log-Likelihood:                -3498.2
## No. Observations:                 733   AIC:                             7004.
## Df Residuals:                     729   BIC:                             7023.
## Df Model:                           3                                         
## Covariance Type:            nonrobust                                         
## ==============================================================================
##                  coef    std err          t      P&gt;|t|      [0.025      0.975]
## ------------------------------------------------------------------------------
## x1            -0.0017      0.002     -0.769      0.442      -0.006       0.003
## x2             0.0128      0.037      0.348      0.728      -0.060       0.085
## x3             0.0853      0.037      2.314      0.021       0.013       0.158
## const          5.3354      5.547      0.962      0.336      -5.555      16.226
## ==============================================================================
## Omnibus:                       47.097   Durbin-Watson:                   2.000
## Prob(Omnibus):                  0.000   Jarque-Bera (JB):              185.653
## Skew:                          -0.056   Prob(JB):                     4.85e-41
## Kurtosis:                       5.463   Cond. No.                     1.32e+04
## ==============================================================================
## 
## Notes:
## [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
## [2] The condition number is large, 1.32e+04. This might indicate that there are
## strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
<div id="필립스-페론phillips-perron-단위근-검정" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 필립스-페론(Phillips-Perron) 단위근 검정<a href="추세와-단위근.html#필립스-페론phillips-perron-단위근-검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>DF-검정에서는 오차항 <span class="math inline">\(u_t\)</span>가 i.i.d. 정규분포한다고 가정한다. 그러나 많은 금융-경제시계열의 오차항 <span class="math inline">\(u_t\)</span>는 오히려 이분산 특성을 가지고 있고 자기상관이 있는 경우도 있을 것이다. Phillips(1987)와 Perreon(1988)은 <span class="math inline">\(x_t\)</span>의 확률 오차항이 약종속성(weakly dependent)을 띄거나 이분산성을 지닌 것으로 생각되는 경우 사용할 수 있는 비모수적 단위근 검정방법을 제안하였다. 즉, 확률 오차항에 대해 정규성이라는 어떤 강한 가정을 하지 않고자 하는 경우 귀무가설 <span class="math inline">\(\alpha = 1\)</span>을 검정하기 위하여 Phillips는 다음의 z-통계량을 계산할 것을 제안하였다.</p>
<p><span class="math display">\[
z(\hat{\alpha}) = T(\hat{\alpha}-1) - \frac{1}{2}(S^2_{Tl}-S^2_u)/(T^{-2}\sum x^2_{t-1}) \\
z(t_{\hat{\alpha}}) = (\sum x^2_{t-1})^{1/2}(\hat{\alpha}-1)/S_{Tl} - \frac{1}{2}(S^2_{Tl}-S^2_u)[S_{Tl}(T^{-2}\sum x^2_{t-1})^{1/2})]^{-1}
\]</span></p>
<p>이때 <span class="math inline">\(S^2_u, S^2_{Tl}\)</span>은 각각 다음과 같은 모수의 표본통계량을 나타낸다.</p>
<p><span class="math display">\[
\sigma^2_u = \lim_{T\rightarrow \infty} T^{-1} \sum ^T_{t=1} E(u^2_t) \\
\sigma^2 = \lim_{T\rightarrow \infty} E(T^{-1}S^2_T), \qquad S_T = \sum^T_{i=1} u_i
\]</span></p>
<p>이 통계량들의 차이를 구체적으로 비교해 보기 위하여 다음과 같이 <span class="math inline">\(u_t\)</span>가 MA(1)과정인 예를 들어보자. 즉, <span class="math inline">\(u_t = a_t + \theta a_{t-1}, \ a_t \sim i.i.d. (0,\sigma^2_a)\)</span>이다. 이 경우</p>
<p><span class="math display">\[
\sigma^2_u = \lim_{T\rightarrow \infty} T ^{-1}\sum^T_{t=1} E(u^2_t)= (1+\theta^2)\sigma^2_a \\
\sigma^2 =  \lim_{T\rightarrow \infty} E(T^{-1}S^2_T) = (1+\theta)^2\sigma^2_a
\]</span></p>
<p>따라서 <span class="math inline">\(\theta = 0\)</span>, 즉 <span class="math inline">\(\alpha_t\)</span>가 DF의 경우와 같이 백색잡음이면 <span class="math inline">\(\sigma^2_u = \sigma^2 = \sigma^2_a\)</span>임을 알 수 있다.</p>
<p><span class="math display">\[
S^2_u = T^{-1} \sum (x_t - \hat{\alpha} x_{t-1})^2 \\
S^2_{Tl} = T^{-1} \sum^T_{t=1} E(u^2_t) + 2 T^{-1} \sum^{T-1}_{\tau=1} \sum^{T}_{t=\tau+1} E(u_t, u_{t-\tau}) \qquad \cdots (1)\\
= T^{-1} \sum^T_{t=1} \hat{u}^2_t + 2 T^{-1} \sum^{T-1}_{\tau=1} \sum^{T}_{t=\tau+1} \hat{u}_t \hat{u}_{t-\tau} \qquad \cdots (2) \\
= T^{-1} \sum^T_{t=1}\hat{u}^2_t + 2 T^{-1} \sum^l_{\tau=1}(1-\frac{\tau}{l+1})\sum^{T}_{t=\tau+1}\hat{u_t}\hat{u_t}_{-\tau} \qquad \cdots (3)
\]</span></p>
<p>위 식 (2)을 살펴보면 오차항 곱들의 기대값 대신 OLS 잔차항을 사용함을 알 수 있다. 이를 <strong>‘Hansen-Hodrick(1980) 추정량’</strong>이라고도 부른다.</p>
<p>그러나 실증분석에서 식 (2)의 HH 추정량 계산 방식을 사용하여 <span class="math inline">\(S^2_{Tl}\)</span>을 계산하면 이것이 음의 값을 취하는 경우가 종종 있다. 따라서 항상양의 값을 갖고 일차추정량인 <span class="math inline">\(S^2_{Tl}\)</span>를 구하기 위하여서는 식 (3)과 같이 첫 번째 합 기호를 특정 래그 <span class="math inline">\(l\)</span>에서 단절하고 <span class="math inline">\(\tau\)</span>-차 공분산 <span class="math inline">\(\hat{u_t}\hat{u_t}_{-\tau}\)</span> 항에 일정한 가중치를 부여하게 된다. 식 (3)에서는 ‘바틀렛 가중치’(Bartlett’s window) <span class="math inline">\(w(\tau, l) = 1 - \tau/(l+1)\)</span>을 사용하고 있고 이러한 방법을 ’Newey-West(1987) 일치추정량’이라고 부른다.</p>
<p>위 식들을 바탕으로 표본통계량을 구했을 때 식의 z-통계량의 극한분포는 Phillips(1987)의 정리에 의하면 다음과 같다.</p>
<p><span class="math display">\[
z(\hat{\alpha}) \Rightarrow (\frac{1}{2})[W(1)^2 - (\sigma^2_u / \sigma^2)]/\int^1_0 W(t)^2dt \\
z(t_{\hat{a}}) \Rightarrow (\sigma/2\sigma_u)[W(1)^2 - (\sigma^2_u/\sigma^2)]/[\int^1_0 W(t)^2dt]^{1/2}
\]</span></p>
<p>이들 극한분포는 앞에서 본 Dickey-Fuller의 극한분포보다 약간 복잡해 보이지만 동일한 임계값 테이블을 통하여 검정할 수 있다.</p>
<p>Newey and West(1987)에 의하면 <span class="math inline">\(S^2_{Tl}\)</span>이 일치추정량이기 위해서는 래그 <span class="math inline">\(l(T)\)</span>가 <span class="math inline">\(T\)</span>보다 느린 <span class="math inline">\(T^{1/4}\)</span>의 비율로 커져야 한다. 즉, <span class="math inline">\(l(T)\sim O(T^{1/4})\)</span>이다. Schwert(1987)는 <span class="math inline">\(l(T) = O(4\cdot(T/100)^{1/4})\)</span> 또는 <span class="math inline">\(l(T) = O(12\cdot(T/100)^{1/4})\)</span>를 제안하고 있다. 따라서 실증분석에서는 <span class="math inline">\(l(T)\)</span>를 충분히 크게 잡아 <span class="math inline">\(S^2_{Tl}\)</span>를 계산하거나 또는 서로 다른 <span class="math inline">\(l(T)\)</span>에 대응하는 <span class="math inline">\(S^2_{Tl}\)</span>을 계산하고 이들로부터의 검정결과가 서로 유사한지를 독자가 판단하도록 하는 것이 보통이다.</p>
<p>DF 또는 ADF 검정의 경우와 같이 PP검정의 경우에도 귀무가설과 OLS 추정식에 추세와 표류항의 추가 여부 또는 단일가설인지 또는 결합가설인지에 따라 통계량의 극한분포가 달라진다. 이에 대하여는 Perron(1988) 또는 Banerjee et al.(1994)를 참조하라.</p>
<div id="예제-phillips-perron을-활용한-kospi-자료의-단위근-검정" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> 예제) Phillips-Perron을 활용한 Kospi 자료의 단위근 검정<a href="추세와-단위근.html#예제-phillips-perron을-활용한-kospi-자료의-단위근-검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ADF검정과 동일한 데이터를 사용하여 진행한다. lag의 경우 <span class="math inline">\(T^{1/4}\)</span>로 자동으로 설정된다.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="추세와-단위근.html#cb161-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-2"><a href="추세와-단위근.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch.unitroot <span class="im">import</span> PhillipsPerron</span>
<span id="cb161-3"><a href="추세와-단위근.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb161-4"><a href="추세와-단위근.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb161-5"><a href="추세와-단위근.html#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="추세와-단위근.html#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="추세와-단위근.html#cb161-7" aria-hidden="true" tabindex="-1"></a>pp <span class="op">=</span> PhillipsPerron(kospi[<span class="st">&quot;Adj Close&quot;</span>], lags<span class="op">=</span><span class="va">None</span>,test_type<span class="op">=</span><span class="st">&#39;tau&#39;</span>)</span>
<span id="cb161-8"><a href="추세와-단위근.html#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pp.summary())</span>
<span id="cb161-9"><a href="추세와-단위근.html#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="추세와-단위근.html#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co">#test type이 &#39;tau&#39;일 경우 t-stat &#39;rho&#39;일 경우 test based on nobs times the re-centered regression coefficient</span></span></code></pre></div>
<pre><code>##      Phillips-Perron Test (Z-tau)    
## =====================================
## Test Statistic                 -0.807
## P-value                         0.817
## Lags                               20
## -------------------------------------
## 
## Trend: Constant
## Critical Values: -3.44 (1%), -2.87 (5%), -2.57 (10%)
## Null Hypothesis: The process contains a unit root.
## Alternative Hypothesis: The process is weakly stationary.</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="추세와-단위근.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Alternative hypothesis is :&quot;</span>)</span></code></pre></div>
<pre><code>## Alternative hypothesis is :</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="추세와-단위근.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pp.alternative_hypothesis)</span></code></pre></div>
<pre><code>## The process is weakly stationary.</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="추세와-단위근.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Null hypothesis is :&quot;</span>)</span></code></pre></div>
<pre><code>## Null hypothesis is :</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="추세와-단위근.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pp.null_hypothesis)</span></code></pre></div>
<pre><code>## The process contains a unit root.</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="추세와-단위근.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="추세와-단위근.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;lag : &quot;</span>, pp.lags)</span></code></pre></div>
<pre><code>## lag :  20</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="추세와-단위근.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;number of observations : &quot;</span>, pp.nobs)</span></code></pre></div>
<pre><code>## number of observations :  735</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="추세와-단위근.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="추세와-단위근.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;p-value : &quot;</span>, pp.pvalue )</span></code></pre></div>
<pre><code>## p-value :  0.8171579241455434</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="추세와-단위근.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;test - statisic of unit root : &quot;</span>, pp.stat)</span></code></pre></div>
<pre><code>## test - statisic of unit root :  -0.8066599541369417</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="추세와-단위근.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pp.regression.summary())</span></code></pre></div>
<pre><code>##                             OLS Regression Results                            
## ==============================================================================
## Dep. Variable:                      y   R-squared:                       0.996
## Model:                            OLS   Adj. R-squared:                  0.996
## Method:                 Least Squares   F-statistic:                 1.688e+05
## Date:                   일, 09 10 2022   Prob (F-statistic):               0.00
## Time:                        20:11:18   Log-Likelihood:                -3510.5
## No. Observations:                 735   AIC:                             7025.
## Df Residuals:                     733   BIC:                             7034.
## Df Model:                           1                                         
## Covariance Type:                  HAC                                         
## ==============================================================================
##                  coef    std err          z      P&gt;|z|      [0.025      0.975]
## ------------------------------------------------------------------------------
## Level.L1       0.9984      0.002    410.896      0.000       0.994       1.003
## const          5.1605      6.471      0.797      0.425      -7.523      17.844
## ==============================================================================
## Omnibus:                       51.299   Durbin-Watson:                   1.973
## Prob(Omnibus):                  0.000   Jarque-Bera (JB):              198.707
## Skew:                          -0.162   Prob(JB):                     7.10e-44
## Kurtosis:                       5.527   Cond. No.                     1.32e+04
## ==============================================================================
## 
## Notes:
## [1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 20 lags and without small sample correction
## [2] The condition number is large, 1.32e+04. This might indicate that there are
## strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
<div id="유사회귀분석" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> 유사회귀분석<a href="추세와-단위근.html#유사회귀분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>적분과정을 따르는 변수를 사용하여 실증분석을 하는 경우 어떠한 문제점이 있을 수 있는지 다음과 같은 Granger and Newbold(1974)의 <strong>유사회귀분석(spurious regression)</strong>의 경우를 예로 들어보자.</p>
<p><span class="math display">\[
y_t = \hat{\alpha} + \hat{\beta}x_t + \hat{u_t}, \qquad t = 1,2,\cdots,T
\]</span></p>
<p>여기서 <span class="math inline">\(y_t\)</span>와 <span class="math inline">\(x_t\)</span>는 서로 독립인 확률보행과정, 즉 I(1)이라고 가정하자.</p>
<p><span class="math display">\[
y_t = y_{t-1} + v_t, \ v_t \sim i.i.d.(0,\sigma^2_v), \ t=1,2,\cdots,T \\
x_t = x_{t-1} + w_t, \ w_t \sim i.i.d. (0,\sigma^2_w), \ t=1,2,\cdots,T
\]</span></p>
<p>단 <span class="math inline">\(Cov(v_t,w_t) = 0\)</span>이다. 즉, 위의 식은 서로 상과없는 두 개의 확률보행과정을 사용하여 회귀분석을 진행한 것이다. 따라서 <span class="math inline">\(\beta\)</span>와 t-통계량, 그리고 <span class="math inline">\(R^2\)</span>은 기무가설하에서 0이어야 한다. OLS 추정량 $과 기타 통계량의 극한분포를 구하면 다음과 같다.</p>
<p><span class="math display">\[
\hat{\beta} = \frac{\sum y_t (x_t - \bar x)}{\sum(x_t - \bar x)^2} \\
= \frac{T^{-2} \sum y_t x_t - T^{-1} \bar y \bar x}{T^{-1} \sum (x_t- \bar x)^2} \\
\Rightarrow \frac{\sigma_v\sigma[\int^1_0 V(t)W(t)dt - \int^1_0V(t)dt \int^1_0 W(t)dt]}{\sigma^2_w[\int^1_0W(t)^2dt - {\int^1_0 W(t)dt}^2]} \\
= (\sigma_v/\sigma_w) \cdot \zeta
\]</span></p>
<p>그러므로 <span class="math inline">\(\hat{beta}\)</span>는 <span class="math inline">\(T \rightarrow \infty\)</span>함에 따라 비함몰(non-degenerate) 극한분포를 가진다. 또한 별도로 예시하지는 않았지만 <span class="math inline">\(\hat{a}\)</span>의 극한분포는 <span class="math inline">\(T\rightarrow \infty\)</span> 함에 따라 확대된다. 그리고 통상의 t-통계량들, 즉 <span class="math inline">\(t_\alpha\)</span>, <span class="math inline">\(t_\beta\)</span>는 극한 분포 자체가 존재하지 않는다.</p>
<p>실제로 <span class="math inline">\(t_\alpha\)</span>와 <span class="math inline">\(t_\beta\)</span>의 분포는 <span class="math inline">\(T\rightarrow\infty\)</span>함에 따라 확대되어 통상의 유의성 검정을 위한 점근적 임계치가 존재하지 않는다.그러나 Phillips는 올바르게 교정한 표준화통계량,즉 <span class="math inline">\({t_\beta}^\prime = t_\beta / \sqrt{T}\)</span>는 다음과 같은 극한 분포를 가진다고 하였다.</p>
<p><span class="math display">\[
T ^ { -1/2 } \cdot t_\beta = \mu/\nu^{1/2}
\]</span></p>
<p>단,</p>
<p><span class="math display">\[
\mu = [\int^1_0 V(t)W(t)dt - \int^1_0 V(t)dt \int^1_0 W(t)dt] \\
\nu = [\int^1_0 V(t)^2dt - (\int^1_0V(t)dt)^2][\int^1_0 W(t)^2dt - (\int^1_0W(t)dt)^2]  - [\int^1_0 V(t)W(t)dt - \int^1_0 V(t)dt \int^1_0 W(t)dt]^2
\]</span></p>
<p>Phillips에 의하면 유사회귀식의 경우 더빈-왓슨 통계량 (DW)은 함몰분포를 갖는다.</p>
<p><span class="math display">\[
DW \xrightarrow{L} 0
\]</span></p>
<p>또한 <span class="math inline">\(R^2\)</span>는 <span class="math inline">\(T \rightarrow \infty\)</span> 함에 따라 비함몰분포를 갖는다. 즉,</p>
<p><span class="math display">\[
R^2 = \frac{\zeta^2[\int^1_0W(t)^2dt - (\int^1_0 W(t)dt)^2]}{\int^1_0V(t)^2dt - (\int^1_0V(t)dt)^2}
\]</span></p>
<p>이상의 결과를 요약하면 서로 관련이 없는 I(1) 변수들끼리 회귀분석하면 회귀계수는 보통 0과 다른 유의적인 값을 취하고 <span class="math inline">\(R^2\)</span>는 높으며 계산된 잔차항은 높은 양의 자기상관을 보여 마치 두 변수가 서로 관계가 있는 것처럼 보이는 위험이 있다는 것이다. 이러한 유사회귀분석의 경우 두 변수의 수준이 아니라 이들을 차분한 뒤 회귀분석하면 두 변수 사이에 관계가 없는 것으로 옳게 나온다.</p>
</div>
<div id="단위근이-있는-시계열의-유사추세-및-사이클" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> 단위근이 있는 시계열의 유사추세 및 사이클<a href="추세와-단위근.html#단위근이-있는-시계열의-유사추세-및-사이클" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nelson은 다음과 같은 동적 선형모형(dynamic linear models; DLM)에서 Dickey-Fuller 현상이 어떻게 작용할 수 있는지를 연구하였다.</p>
<p><span class="math display">\[
x_t = \tau_t + c_t \\
\tau_t = \beta_{t-1} + \tau_{t-1} + w_t \\
\beta_t = \beta_{t-1} + u_t \\
c_t = \phi(L)^{-1}v_t
\]</span></p>
<p>단, <span class="math inline">\(w_t, u_t\)</span> 그리고 <span class="math inline">\(v_t\)</span>는 서로 독립이고 각각의 분산이 <span class="math inline">\(\sigma^2_w, \sigma^2_u\)</span> 그리고 <span class="math inline">\(\sigma^2_v\)</span>인 정규분포 백색잡음이다. 안정적 부분인 <span class="math inline">\(c_t\)</span>는 AR(2)라고 가정하자. 만일 <span class="math inline">\(x_t\)</span>가 대수를 취한 주가이면 추세부분인 <span class="math inline">\(\tau_t\)</span>는 내재가치를, 그리고 안정적 부분인 <span class="math inline">\(c_t\)</span>는 투자심리 부분을 나타낸다. 만일 <span class="math inline">\(x_t\)</span>가 대수를 취한 GDP이면 <span class="math inline">\(\tau_t\)</span>는 확률적 추세(공급충격에 의하여 장기적으로 결정되는 부분)를, 그리고 안정적인 부분인 <span class="math inline">\(c_t\)</span>는 순환변동 (통화 및 재정정책에 의하여 일시적으로 영향을 받는 부분)을 나타낸다고 할 수 있다.</p>
<p>제 2차 세계대전 후 미국의 실질 GNP 자료를 이용하여 Watson(1986)은 위의 식을 상태-공간모형으로 전환한 뒤 칼만필터 연산식을 사용하여 다음과 같은 추정 결과를 얻었다.</p>
<p>$$
\</p>
<p>x_t = <em>t + c_t\
<em>t = 0.0008 + </em>{t-1} + w_t, <em>w = 0.0057 \
c_t = 1.501 c</em>{t-1} - 0.577c</em>{t-2} + v_t, _v = 0.0076 \
대수우도함수값 = 294.42,  S.E. = 0.0099
$$</p>
<p>단, S.E.는 예측오차의 표준편차를 나타낸다. 여기서 순환변동부분을 다음과 같이 표현해보자.</p>
<p><span class="math display">\[
c_t = (\phi_1 + \phi_2)c_{t-1} + \phi_2(c_{t-1}- c_{t-2}) + v_t \\
= 0.924c_{t-1} + 0.577(c_{t-1} - c_{t-2}) + v_t
\]</span></p>
<p>만일 <span class="math inline">\((\phi_1 + \phi_2)\)</span>의 참값이 1이면 최소자승법에 의한 이의 추정량은 영의 방향으로 편의를 보이는 경향이 있다. 즉, Nelson and Kang(1981)의 연구결과에 의하면 <span class="math inline">\(\rho = \phi_1 + \phi_2\)</span>의 참값이 1일때 <span class="math inline">\(\hat{\rho} = \hat{\phi_1} + \hat{\phi_2}\)</span>의 기대값은 0.93(또는 T가 큰 경우 <span class="math inline">\(\approx 1 - 10/T\)</span>로 계산함)이다. Watson의 경우 T는 144이다. 그러므로 안정적인 과정으로 <span class="math inline">\(c_t\)</span>를 추정한 Watson의 결과는 실제로 <span class="math inline">\(\rho = 1\)</span>이고 추세가 다음과 같이 단순한 선행시간추세를 갖는 모형을 추정한 경우의 얻게 되는 편의와 매우 유사함을 알 수 있다.</p>
<p><span class="math display">\[
\tau_t = \tau_{t-1} + \beta \quad (\sigma_w = 0)
\]</span></p>
<p>즉, <span class="math inline">\(\rho = 1\)</span>과 <span class="math inline">\(\sigma_w = \sigma_u = 0\)</span>을 가정하고 정리하면 Watson의 경우는 다음과 같은 추세안정적인 모형을 상태-공간모형을 이용하여 추정한 것과 같게 된다.</p>
<p><span class="math display">\[
x_t = \rho x_{t-1} + \beta t + \phi(c_{t-1} - c_{t-2}) + v_t
\]</span></p>
<p>따라서 참값이 <span class="math inline">\(\rho = 1\)</span>임에도 이의 OLS 추정치가 1보다 작게 되는 ’Dickey_Fuller현상’이 상태-공간모형에 의하여 추정하는 경우에 발생할 수 있다는 것이다.</p>
<p>상태-공간모형에서 이러한 유사추세 및 사이클(spurious tredn and cycle)이 발생할 수 있는지를 실증적으로 규명하기 위하여 Nelson은 사이클이 전혀 없는 확률보행과정을 시뮬레이션하였다. 그리고 이 자료를 이용하여 추정환 결과 상태-공간모형은 전형적으로 추세부분을 원래보다 매우 스무드한 것으로 추정하며(즉,<span class="math inline">\(\sigma_w\)</span>가 매우 작게 추정됨), 자료 변동의 대부분이(그릇되게) 자기상관이 매우 높은 사이클로부터 비롯하는 것처럼 나타나는 경향이 있음을 발견하였다. 또한 유사사이클이 추정해내는 모형이 자료생성과정(즉, 확률보행과정)의 경우보다 통상의 기준에서 볼 대 대수우도함수값이 유의적으로 높은 것으로 나타났다. 요약하면 단위근이 있는 자료를 사용하여 이를 확률보행과정 추세와 안정적 사이클로 분해되는 경우 유사추세와 유사사이클을 추정한 것인지 또는 실제로 어떤 것을 발견한 것인지 결론을 내릴 때 특별한 주의가 필요하다는 것이다.</p>
</div>
<div id="시간추세-안정적-시계열과-차분안정적-시계열의-선택문제" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> 시간추세 안정적 시계열과 차분안정적 시계열의 선택문제<a href="추세와-단위근.html#시간추세-안정적-시계열과-차분안정적-시계열의-선택문제" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>단위근이 있는 시계열은 다음의 예와 같이 차분하면 안정적인 계열이 된다.</p>
<p><span class="math display">\[
\Delta x_t = \mu + a_t
\]</span></p>
<p>즉, ST 시계열은 차분함으로써 추세를 제거할 수 있다. 반면에 식에 예시한 DT 시계열은 선형시간추세를 제거한 후 안정적인 계열이 된다.</p>
<p><span class="math display">\[
x_t - \alpha - \mu t = u_t
\]</span></p>
<p>8.1절에서 설명한 것처럼 확률보행과정은 반복 대입을 통해 다음과 같이 다시 표현할 수 있으며 추세안정적 시계열과 차분안정적 시계열은 서로 유사성이 있음을 알 수 있다.</p>
<p><span class="math display">\[
x_t = x_0 + \mu \cdot t + \sum^t_{i=1} a_t = \alpha + \mu \cdot t + u_t
\]</span></p>
<p>여기서 <span class="math inline">\(x_0\)</span>는 임의의 초기값을 나타낸다. 위의 두 식의 표현의 유사성에도 불구하고 이들의 오차항 <span class="math inline">\(u_t\)</span>의 특성은 확연히 다르다. 즉, 후자의 경우는 과거 및 현재의 오차항의 합으로 표현되어 있어 <span class="math inline">\(u_t\)</span>의 분산은 <span class="math inline">\(t\sigma^2_a\)</span>으로 시간이 경과함에 따라 점차 증가하게 된다. 이러한 차이점은 장기예측의 경우 확연하다. 전자의 경우 장기예측치는 현재 또는 과거의 오차항 값에 관계없이 항상 <span class="math inline">\(\alpha + \mu t\)</span>인 반면 후자는 과거부터 현재까지 누적된 오차항 (또는 이벤트)에 영향을 받는다.</p>
<p>Nelson and Kang(1981,1984)은 자료생성과정이 차분안정적 과정일 때 이를 시간추세 안정적과정으로 잘못 간주하고 분석하는 경우 어떠한 결과가 초래되는지를 집중분석하였다. 이들의 연구결과를 요약하면 다음과 같다.</p>
<ol style="list-style-type: decimal">
<li><p>표류항 <span class="math inline">\(\mu\)</span>가 없는 확률보행과정을 시간에 대하여 OLS 추정하면 <span class="math inline">\(R^2\)</span> 값이 표본의 크기에 관계없이 약 0.44가 된다. 표류항이 있는 경우에 <span class="math inline">\(R^2\)</span> 값은 표본의 크기가 증가함에 따라 증가하며 점차 1.0에 근사한다.</p></li>
<li><p>확률보행과정을 시간에 대하여 OLS 추정한 후 구한 잔차항의 분산은 표본의 크기가 표류항의 크기에 관계없이 평균적으로 <span class="math inline">\(\Delta x_t = \mu + a_t\)</span>의 <span class="math inline">\(\sigma^_a\)</span>의 약 14%에 불과하다.</p></li>
<li><p>확률보행모형으로부터 (그릇되게) 시간추세를 제거한 후 얻은 잔차항의 표본자기상관계수의 평군값은 표본의 크기 T의 함수이며 래그 1에서 대략 (1-10/T)이다. 물론 원래의 확률보행모형의 오차항은 백색잡음이므로 이러한 자기상관들은 순전히 ‘통계적 허상’(statistical artifiact)이다. SACF는 약 (2/3)T의 주기로 순환한다. 따라서 시간추세 자료는 (그릇되게) 유사장기사이클(suprious long cycle)을 보인다.</p></li>
<li><p>통상의 t-통계량을 사용하여 시간추세의 회귀계수 <span class="math inline">\(\mu\)</span>가 0이라는 귀무가설을 검정하는 경우 표본의 크기가 100이고 5% 유의수준을 적용하면 귀무가설이 사실임에도 이를 87% 기각하였다.</p></li>
</ol>
<p>따라서 차분안정적인 시계열을 추세안정적인 시계열로 착각하는 경우 매우 심각한 오류를 초래할 수 있다는 것이다. 그러면 추세안정적인 자료를 실수로 차분하여 사용하면 어떠한 결과가 초래될 것인가? Plosser and Schwert(1977,1978)의 연구결과에 의하면 이 경우의 오류가능성은 앞의 경우에 비해서는 그리 크지 않다는 것이다. 따라서 실증분석에 있어서는 추세안정적인지 또는 차분안정적인지 불분명한 경우에는 후자로 가정하는 것이 덜 위험하다고 볼 수 있다.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="불안정적-시계열모형의-추정과-예측.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/8_추세와_단위근.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
